{"Data":{"Sdk":{"Events":[{"Id":"7757795876","Type":"PullRequestEvent","CreatedAt":"2018-05-31T17:28:08","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/504","RelatedDescription":"Merged pull request \"Update System.IO.Packaging to 4.5.0\" (#504) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #221, #401 "},{"Id":"7757795856","Type":"IssuesEvent","CreatedAt":"2018-05-31T17:28:08","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/221","RelatedDescription":"Closed issue \"Documents fail to open on Mono with System.IO.Packaging library\" (#221) at OfficeDev/Open-XML-SDK","RelatedBody":"When I use the following code：\r\n[https://msdn.microsoft.com/en-us/library/office/gg575571.aspx](https://msdn.microsoft.com/en-us/library/office/gg575571.aspx)\r\n```\r\nstatic void ReadExcelFileDOM(string fileName)\r\n{\r\n    using (SpreadsheetDocument spreadsheetDocument = SpreadsheetDocument.Open(fileName, false))\r\n    {\r\n        WorkbookPart workbookPart = spreadsheetDocument.WorkbookPart;\r\n        WorksheetPart worksheetPart = workbookPart.WorksheetParts.First();\r\n        SheetData sheetData = worksheetPart.Worksheet.Elements<SheetData>().First();\r\n        string text;\r\n        foreach (Row r in sheetData.Elements<Row>())\r\n        {\r\n            foreach (Cell c in r.Elements<Cell>())\r\n            {\r\n                text = c.CellValue.Text;\r\n                Console.Write(text + \" \");\r\n            }\r\n        }\r\n        Console.WriteLine();\r\n        Console.ReadKey();\r\n    }\r\n}\r\n```\r\n\r\n\r\n SpreadsheetDocument.Open() will report error\r\n**PackageRelationship target must be relative URI if TargetMode is Internal.\r\nParameter name: targetUri**\r\n![ece33856-977e-4ca2-a4ed-130577397063](https://user-images.githubusercontent.com/13383393/28519921-0782dae2-70a0-11e7-8870-af5043796c80.png)\r\n\r\n\r\nIDE: Visual Studio for Mac\r\n.NET Runtime: Mono 5.0.1.1\r\nOpenXML: 2.7.2.0\r\nOS: macOS 10.12.5 "},{"Id":"7752516033","Type":"PullRequestEvent","CreatedAt":"2018-05-30T20:32:27","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/505","RelatedDescription":"Merged pull request \"Add SR.Format to simplify string formatting of exceptions\" (#505) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7751948349","Type":"PullRequestEvent","CreatedAt":"2018-05-30T18:41:53","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/505","RelatedDescription":"Opened pull request \"Add SR.Format to simplify string formatting of exceptions\" (#505) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7750856631","Type":"PullRequestEvent","CreatedAt":"2018-05-30T15:23:16","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/504","RelatedDescription":"Opened pull request \"Update System.IO.Packaging to 4.5.0\" (#504) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #221 "}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[{"Id":"7767513467","Type":"IssuesEvent","CreatedAt":"2018-06-03T07:16:04","Actor":"YoungroKim","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/225","RelatedDescription":"Closed issue \"The bookmark ID may also be a string.\" (#225) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"The bookmark ID can also be a string. However, the code below assumes that the bookmark ID always contains only digits.\r\n\r\nDocumentBuilder.cs\r\n\r\n`\r\nprivate static void AdjustUniqueIds(WordprocessingDocument sourceDocument,\r\n            WordprocessingDocument newDocument, IEnumerable<XElement> newContent)\r\n        {\r\n            ......\r\n                int id = (int)item.Attribute(W.id);\r\n                if (!bookmarkIdMap.ContainsKey(id))\r\n                    bookmarkIdMap.Add(id, ++maxId);\r\n......\r\n        }\r\n`"},{"Id":"7767499472","Type":"IssuesEvent","CreatedAt":"2018-06-03T07:04:02","Actor":"YoungroKim","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/225","RelatedDescription":"Opened issue \"The bookmark ID may also be a string.\" (#225) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"The bookmark ID can also be a string. However, the code below assumes that the bookmark ID always contains only digits.\r\n\r\nDocumentBuilder.cs\r\n`private static void AdjustUniqueIds(WordprocessingDocument sourceDocument,\r\n            WordprocessingDocument newDocument, IEnumerable<XElement> newContent)\r\n        {\r\n            // adjust bookmark unique ids\r\n            int maxId = 0;\r\n            if (newDocument.MainDocumentPart.GetXDocument().Descendants(W.bookmarkStart).Any())\r\n                maxId = newDocument.MainDocumentPart.GetXDocument().Descendants(W.bookmarkStart)\r\n                    .Select(d => (int)d.Attribute(W.id)).Max();\r\n            Dictionary<int, int> bookmarkIdMap = new Dictionary<int, int>();\r\n            foreach (var item in newContent.DescendantsAndSelf().Where(bm => bm.Name == W.bookmarkStart ||\r\n                bm.Name == W.bookmarkEnd))\r\n            {\r\n                **int id = (int)item.Attribute(W.id);**\r\n                if (!bookmarkIdMap.ContainsKey(id))\r\n                    bookmarkIdMap.Add(id, ++maxId);\r\n            }\r\n            foreach (var bookmarkElement in newContent.DescendantsAndSelf().Where(e => e.Name == W.bookmarkStart ||\r\n                e.Name == W.bookmarkEnd))\r\n                bookmarkElement.Attribute(W.id).Value = bookmarkIdMap[(int)bookmarkElement.Attribute(W.id)].ToString();\r\n\r\n            // adjust shape unique ids\r\n            // This doesn't work because OLEObjects refer to shapes by ID.\r\n            // Punting on this, because sooner or later, this will be a non-issue.\r\n            //foreach (var item in newContent.DescendantsAndSelf(VML.shape))\r\n            //{\r\n            //    Guid g = Guid.NewGuid();\r\n            //    string s = \"R\" + g.ToString().Replace(\"-\", \"\");\r\n            //    item.Attribute(NoNamespace.id).Value = s;\r\n            //}\r\n        }`"},{"Id":"7709896413","Type":"IssuesEvent","CreatedAt":"2018-05-22T10:35:33","Actor":"VictorIranzo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/224","RelatedDescription":"Opened issue \"ChartUpdater: Support for Combo charts\" (#224) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Hi,\r\nWe are interested in ChartUpdater working with Combo charts. The combo charts are those that mix series of different chart types. A combo chart can be done using Word as shown at the screenshot:\r\n \r\n![image](https://user-images.githubusercontent.com/27296704/40357379-4cb39ce6-5dbc-11e8-9440-dc050b7c3ce6.png)\r\n\r\nWe have tested the current ChartUpdater component for replacing the values of this chart in a DOCX:\r\n \r\n![image](https://user-images.githubusercontent.com/27296704/40357386-53e63dfc-5dbc-11e8-9e1e-475d3d3267a1.png)\r\n\r\nThis chart combines two series: one is a bar chart and the other a line chart, with only the dots and in the secondary axis.\r\n\r\nWe provide in this repository an application that tests this: \r\nhttps://github.com/VictorIranzo/UpdateComboChart \r\n\r\nThe result obtained is not the expected one. It seems that the ChartUpdater has added the new values of the two series in the bar chart section and has kept the section of the line chart. We couldn’t open the output document using Word, but if we use another editor like LibreOffice we see the mentioned result:\r\n \r\n![image](https://user-images.githubusercontent.com/27296704/40357400-5ca8e692-5dbc-11e8-9a7b-4bdb94b3e685.png)\r\n\r\nAs you see, there are 3 series. The ‘Percentage’ series contains the data of the old chart. If we remove the line series manually opening the ‘chart1.xml’ file of the document, we realize that the values provided for the new chart have been inserted in the bar chart section:\r\n\r\n![image](https://user-images.githubusercontent.com/27296704/40357421-6c11038a-5dbc-11e8-924d-ce533c87e458.png)\r\n \r\nAs we said, we are interested in this feature. We would like to know if you have planned to implement this feature.\r\nThanks \r\n\r\n\r\n"},{"Id":"7684222300","Type":"IssuesEvent","CreatedAt":"2018-05-16T15:44:11","Actor":"dionisor","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/223","RelatedDescription":"Opened issue \"Unable to Import Module Open-xml-powertools\" (#223) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"I want to use powershell modules so I´ve tried next instructions:\r\n\r\n```\r\nThe short form of the installation instructions are:\r\n\r\n1. Make sure you are running PowerShell 3.0 or later\r\nPS C:\\WINDOWS\\system32> $PSVersionTable.PSVersion\r\n\r\nMajor  Minor  Build  Revision\r\n-----  -----  -----  --------\r\n5      1      16299  431\r\n2. If necessary, run PowerShell as administrator, Set-ExecutionPolicy Unrestricted (or RemoteSigned)\r\nPS C:\\WINDOWS\\system32> Get-ExecutionPolicy\r\nUnrestricted\r\n3. Clone Open-Xml-PowerTools to %HOMEDRIVE%/%HOMEUSER%/Documents/WindowsPowerShell/Modules/Open-Xml-PowerTools\r\nC:\\Users\\dionisor\\Documents\\WindowsPowerShell\\Modules>git clone https://github.com/OfficeDev/Open-Xml-PowerTools.git\r\nCloning into 'Open-Xml-PowerTools'...\r\nremote: Counting objects: 2884, done.\r\nremote: Compressing objects: 100% (2/2), done.\r\nremote: Total 2884 (delta 26), reused 25 (delta 25), pack-reused 2857\r\nReceiving objects: 100% (2884/2884), 22.11 MiB | 7.91 MiB/s, done.\r\nResolving deltas: 100% (1773/1773), done.\r\nChecking out files: 100% (1394/1394), done.\r\n\r\nC:\\Users\\dionisor\\Documents\\WindowsPowerShell\\Modules>cd Open-Xml-PowerTools\r\nC:\\Users\\amachado\\Documents\\WindowsPowerShell\\Modules\\Open-Xml-PowerTools>git checkout -b master origin/master\r\nSwitched to a new branch 'master'\r\nBranch 'master' set up to track remote branch 'master' from 'origin'.\r\n4. Import the module in PowerShell: Import-Module Open-Xml-PowerTools\r\nNot find files:\r\n'C:\\Users\\dionisor\\Documents\\Open-Xml-Sdk\\DocumentFormat.OpenXml\\bin\\debug\\DocumentFormat.OpenXml.dll'\r\n'C:\\Users\\dionisor\\Documents\\Open-Xml-Sdk\\DocumentFormat.OpenXml\\bin\\debug\\System.IO.Packaging.dll'\r\n\r\n```\r\nHow can I use it?\r\n\r\nThanks\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2018-06-06T05:30:44.3230054Z","RunDurationInMilliseconds":1878}