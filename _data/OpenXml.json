{"Data":{"Sdk":{"Events":[{"Id":"6678820819","Type":"IssuesEvent","CreatedAt":"2017-10-05T15:22:31","Actor":"tarunchopra","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/247","RelatedDescription":"Closed issue \"Excel file: Specified part does not exist in the package.\" (#247) at OfficeDev/Open-XML-SDK","RelatedBody":"Hello\r\nI have an Excel file directly created by Microsoft Excel. When I try to open it with SpreadsheetDocument.Open(), I get exception of Specified part does not exist in the package.\r\n\r\nI'm using NuGet 2.7.2\r\n\r\nException details:\r\nSource: WindowsBase\r\nTarget site: System.IO.Packaging.Package.GetPart(System.Uri)\r\n\r\nCould you please help?\r\n\r\n[DB84080A-8AB9-49AB-A607-0367D6A7F73ABook1.xlsx](https://github.com/OfficeDev/Open-XML-SDK/files/1327144/DB84080A-8AB9-49AB-A607-0367D6A7F73ABook1.xlsx)\r\n"},{"Id":"6669384146","Type":"IssuesEvent","CreatedAt":"2017-10-03T19:08:46","Actor":"andrecalil","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/250","RelatedDescription":"Closed issue \"On Excel, Table fields lose formulas and format\" (#250) at OfficeDev/Open-XML-SDK","RelatedBody":"Hey there,\r\n\r\nWe noticed that if you have an Excel spreadsheet with a table and some of its columns have calculated or formatted values, these properties (either the formula or the format) will be lost on the table definition if the file is loaded using OpenXML.\r\n\r\nThis was initially noticed on ClosedXML, a library that relies on OpenXML for all the heavy lifting. Further details can be found on [this issue](https://github.com/ClosedXML/ClosedXML/issues/513).\r\n\r\nI cloned ClosedXML repo and got the source code. When debugging, I noticed that, in a given moment, it would call OpenXML to parse all the file to objects. This is the line where it happens:\r\n\r\n```\r\nusing (var dSpreadsheet = SpreadsheetDocument.Open(fileName, true))\r\n                LoadSpreadsheetDocument(dSpreadsheet);\r\n```\r\n\r\nAfter that, if you peek into the table definitions that were loaded, you'll see that the formula and formats have been lost.\r\n\r\nTo be clear, this is what I'm referring to:\r\n**\\xl\\tables\\table1,xml**\r\n```\r\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\r\n<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Tabela1\" displayName=\"Tabela1\" ref=\"B2:F3\" totalsRowShown=\"0\">\r\n\t<autoFilter ref=\"B2:F3\"/>\r\n\t<tableColumns count=\"5\">\r\n\t\t<tableColumn id=\"1\" name=\"colum1\"/>\r\n\t\t<tableColumn id=\"2\" name=\"colum2\"/>\r\n\t\t<tableColumn id=\"3\" name=\"colum3\" dataCellStyle=\"Vírgula\"/> <!-- THIS -->\r\n\t\t<tableColumn id=\"4\" name=\"colum4\"/>\r\n\t\t<tableColumn id=\"5\" name=\"colum5\"><calculatedColumnFormula>Tabela1[colum4]+Tabela1[colum3]+Tabela1[colum2]+Tabela1[colum1]</calculatedColumnFormula></tableColumn> <!-- AND THIS -->\r\n\t</tableColumns>\r\n\t<tableStyleInfo name=\"TableStyleMedium2\" showFirstColumn=\"0\" showLastColumn=\"0\" showRowStripes=\"1\" showColumnStripes=\"0\"/>\r\n</table>\r\n```\r\nThis can be found if you rename XLSX to ZIP and go sniffing into it. Those parts get lost on OpenXML.\r\n\r\nI can try and get into this on my own, if you'd like. Any direction on where to get started would be much appreciated."},{"Id":"6665912269","Type":"IssuesEvent","CreatedAt":"2017-10-03T05:04:13","Actor":"tarunchopra","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/248","RelatedDescription":"Reopened issue \"Issue with OpenXmlValidator\" (#248) at OfficeDev/Open-XML-SDK","RelatedBody":"Hi,\r\nWhen we validate an .xlsx file that has a pivot table that use the feature \"Add this data to the Data Model\" we are not able to validate the openxml file.\r\nWe are getting the error:\r\n\"The attribute 'type' has invalid value '102'. The MaxInclusive constraint failed. The value must be less than or equal to 8.\"\r\n\r\nin the connections.xml file i can see the connection type \"102\"\r\n`<connection id=\"2\" xr16:uid=\"{00000000-0015-0000-FFFF-FFFF01000000}\" name=\"WorksheetConnection_TestReportTemplate.xlsx!SOURCE_TABLE\" type=\"102\" refreshedVersion=\"6\" minRefreshableVersion=\"5\">\r\n\t\t<extLst>\r\n\t\t\t<ext uri=\"{DE250136-89BD-433C-8126-D09CA5730AF9}\" xmlns:x15=\"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main\">\r\n\t\t\t\t<x15:connection id=\"SOURCE_TABLE\" autoDelete=\"1\">\r\n\t\t\t\t\t<x15:rangePr sourceName=\"_xlcn.WorksheetConnection_TestReportTemplate.xlsxSOURCE_TABLE1\"/>\r\n\t\t\t\t</x15:connection>\r\n\t\t\t</ext>\r\n\t\t</extLst>\r\n\t</connection>`\r\n\r\nI have researched a bit and i could find that the type 102 is part of the standard of openXML\r\n[https://msdn.microsoft.com/en-us/library/documentformat.openxml.office2013.excel.connection.aspx](https://msdn.microsoft.com/en-us/library/documentformat.openxml.office2013.excel.connection.aspx)\r\nf this element is present, then the type attribute of the ancestor CT_Connection element, as specified in [ISO/IEC-29500-4] section A.2, MUST be equal to \"102\".\r\n\r\nIt seems to me like a bug with OpenXML. \r\n\r\nCould you please review and let me know if i am doing something wrong.\r\n\r\nThanks,\r\nNoam\r\n"},{"Id":"6665911948","Type":"IssuesEvent","CreatedAt":"2017-10-03T05:04:03","Actor":"tarunchopra","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/248","RelatedDescription":"Closed issue \"Issue with OpenXmlValidator\" (#248) at OfficeDev/Open-XML-SDK","RelatedBody":"Hi,\r\nWhen we validate an .xlsx file that has a pivot table that use the feature \"Add this data to the Data Model\" we are not able to validate the openxml file.\r\nWe are getting the error:\r\n\"The attribute 'type' has invalid value '102'. The MaxInclusive constraint failed. The value must be less than or equal to 8.\"\r\n\r\nin the connections.xml file i can see the connection type \"102\"\r\n`<connection id=\"2\" xr16:uid=\"{00000000-0015-0000-FFFF-FFFF01000000}\" name=\"WorksheetConnection_TestReportTemplate.xlsx!SOURCE_TABLE\" type=\"102\" refreshedVersion=\"6\" minRefreshableVersion=\"5\">\r\n\t\t<extLst>\r\n\t\t\t<ext uri=\"{DE250136-89BD-433C-8126-D09CA5730AF9}\" xmlns:x15=\"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main\">\r\n\t\t\t\t<x15:connection id=\"SOURCE_TABLE\" autoDelete=\"1\">\r\n\t\t\t\t\t<x15:rangePr sourceName=\"_xlcn.WorksheetConnection_TestReportTemplate.xlsxSOURCE_TABLE1\"/>\r\n\t\t\t\t</x15:connection>\r\n\t\t\t</ext>\r\n\t\t</extLst>\r\n\t</connection>`\r\n\r\nI have researched a bit and i could find that the type 102 is part of the standard of openXML\r\n[https://msdn.microsoft.com/en-us/library/documentformat.openxml.office2013.excel.connection.aspx](https://msdn.microsoft.com/en-us/library/documentformat.openxml.office2013.excel.connection.aspx)\r\nf this element is present, then the type attribute of the ancestor CT_Connection element, as specified in [ISO/IEC-29500-4] section A.2, MUST be equal to \"102\".\r\n\r\nIt seems to me like a bug with OpenXML. \r\n\r\nCould you please review and let me know if i am doing something wrong.\r\n\r\nThanks,\r\nNoam\r\n"},{"Id":"6664788136","Type":"IssuesEvent","CreatedAt":"2017-10-02T21:29:05","Actor":"andrecalil","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/250","RelatedDescription":"Opened issue \"On Excel, Table fields lose formulas and format\" (#250) at OfficeDev/Open-XML-SDK","RelatedBody":"Hey there,\r\n\r\nWe noticed that if you have an Excel spreadsheet with a table and some of its columns have calculated or formatted values, these properties (either the formula or the format) will be lost on the table definition if the file is loaded using OpenXML.\r\n\r\nThis was initially noticed on ClosedXML, a library that relies on OpenXML for all the heavy lifting. Further details can be found on [this issue](https://github.com/ClosedXML/ClosedXML/issues/513).\r\n\r\nI cloned ClosedXML repo and got the source code. When debugging, I noticed that, in a given moment, it would call OpenXML to parse all the file to objects. This is the line where it happens:\r\n\r\n```\r\nusing (var dSpreadsheet = SpreadsheetDocument.Open(fileName, true))\r\n                LoadSpreadsheetDocument(dSpreadsheet);\r\n```\r\n\r\nAfter that, if you peek into the table definitions that were loaded, you'll see that the formula and formats have been lost.\r\n\r\nTo be clear, this is what I'm referring to:\r\n**\\xl\\tables\\table1,xml**\r\n```\r\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\r\n<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Tabela1\" displayName=\"Tabela1\" ref=\"B2:F3\" totalsRowShown=\"0\">\r\n\t<autoFilter ref=\"B2:F3\"/>\r\n\t<tableColumns count=\"5\">\r\n\t\t<tableColumn id=\"1\" name=\"colum1\"/>\r\n\t\t<tableColumn id=\"2\" name=\"colum2\"/>\r\n\t\t<tableColumn id=\"3\" name=\"colum3\" dataCellStyle=\"Vírgula\"/> <!-- THIS -->\r\n\t\t<tableColumn id=\"4\" name=\"colum4\"/>\r\n\t\t<tableColumn id=\"5\" name=\"colum5\"><calculatedColumnFormula>Tabela1[colum4]+Tabela1[colum3]+Tabela1[colum2]+Tabela1[colum1]</calculatedColumnFormula></tableColumn> <!-- AND THIS -->\r\n\t</tableColumns>\r\n\t<tableStyleInfo name=\"TableStyleMedium2\" showFirstColumn=\"0\" showLastColumn=\"0\" showRowStripes=\"1\" showColumnStripes=\"0\"/>\r\n</table>\r\n```\r\nThis can be found if you rename XLSX to ZIP and go sniffing into it. Those parts get lost on OpenXML.\r\n\r\nI can try and get into this on my own, if you'd like. Any direction on where to get started would be much appreciated."}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[{"Id":"6644112338","Type":"IssuesEvent","CreatedAt":"2017-09-27T13:47:58","Actor":"kaviyarasanaspire","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/186","RelatedDescription":"Opened issue \"While applying background color in the html theme is applied in the wml file\" (#186) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"While applying background color for the text before the image with different font the theme is applied in the wml file and assigning different font.\r\n <w:rFonts w:asciiTheme=\"minorHAnsi\" w:eastAsiaTheme=\"minorHAnsi\" w:hAnsiTheme=\"minorHAnsi\" w:cstheme=\"minorBidi\" />\r\n\r\nCan anyone please give me the solution for this.\r\n"},{"Id":"6638589438","Type":"IssuesEvent","CreatedAt":"2017-09-26T14:07:27","Actor":"ben-demotic","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/185","RelatedDescription":"Opened issue \"DocumentAssembler - vNext line 558 - p.Elements().Count()\" (#185) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Hi Eric\r\n\r\nThanks for the great library.  I just discovered OpenXmlPowerTools recently and am using it to replace my old RTF based token replacement with DOCX to really save on those storage costs!\r\n\r\nAnyway, while working with some multi-line address data, delimited by '\\n', I had a problem whereby not all of the <br/> elements were being inserted.\r\n\r\nFor example, say I have this text:\r\n\r\n17 Shire Oak Road\\nSaxlingham\\nNR15 5TR\r\n\r\nI have 2 documents where I am attempting to insert this data formatted with new lines as an address.  The first document, the token is replaced by the following which correctly contains a <br/> inserted before the 2nd and 3rd elements:\r\n\r\n```\r\n<?xml version=\"1.0\"?>\r\n   <p xmlns=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\r\n      <pPr>\r\n         <pStyle xmlns:p3=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" \r\n              p3:val=\"NoSpacing\"/>\r\n         <rPr>\r\n            <bCs/>\r\n         </rPr>\r\n      </pPr>\r\n      <r>\r\n         <rPr>\r\n            <bCs/>\r\n         </rPr>\r\n         <t>17 Shire Oak Road</t>\r\n      </r>\r\n      <r>\r\n         <rPr>\r\n            <bCs/>\r\n         </rPr>\r\n         <br/>\r\n         <t>Saxlingham</t>\r\n      </r>\r\n      <r>\r\n         <rPr>\r\n            <bCs/>\r\n         </rPr>\r\n         <br/>\r\n         <t>NR15 5TR</t>\r\n      </r>\r\n   </p>\r\n```\r\nThe second document does not have the extra <rPr><bCs/><rPr> of the first and if you look you can see that it has not put the <br/> before the second element.\r\n\r\n```\r\n<?xml version=\"1.0\"?>\r\n   <p xmlns=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\r\n      <r>\r\n         <t>17 Shire Oak Road</t>\r\n      </r>\r\n      <r>\r\n         <t>Saxlingham</t>\r\n      </r>\r\n      <r>\r\n         <br/>\r\n         <t>NR15 5TR</t>\r\n      </r>\r\n   </p>\r\n```\r\n\r\nAm I right in saying that their is a bug here in that the test for p.Elements().Count() on line 558 should test for > 0 not > 1 ??  And that the only reason why it works in the first case is because of the extra guff which is present artificially increasing p.Elements().Count()?  And that it should test only for a count of the <W:r> element?  Should it in fact show:\r\n\r\n(p.Elements(W.r).Count() > 0)\r\n\r\nThis seems to work in my use case.\r\n\r\nCheers\r\n\r\nBen\r\n"},{"Id":"6619868836","Type":"IssuesEvent","CreatedAt":"2017-09-21T13:48:37","Actor":"mesteves","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/184","RelatedDescription":"Opened issue \"binding directives in tables\" (#184) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Hi,\r\n\r\nI'm trying to use DocumentAssembler to generate documents based on xml files, and using repeat directive associated with table directive, i'm not being able to:\r\n\r\n1. Use two expressions in one cell of the prototype row (like ./Price ./CurrencySymbol )\r\n2. Use select content expression on table header. (like **Price** `<# <Content Select=\"./SaleItems/SaleItem[1]/@Currency\"/> #>` ) - produces invalid document\r\n\r\nAny help on this would be appreciated,\r\n\r\nBest regards,\r\nManuel"},{"Id":"6605978130","Type":"PullRequestEvent","CreatedAt":"2017-09-18T21:35:41","Actor":"kimsey0","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/183","RelatedDescription":"Opened pull request \"Merge styles with same name in DocumentBuilder\" (#183) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Solves #181.\r\n\r\nCurrently implemented with a compile-time feature flag, but this could easily be changed to an optional parameter passed to DocumentBuilder at run-time.\r\n\r\nIt is likely possible to clean up the section that maps style IDs in references and numberings so that it doesn't have to go through as many elements."},{"Id":"6605910896","Type":"PullRequestEvent","CreatedAt":"2017-09-18T21:18:46","Actor":"EricWhiteDev","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/180","RelatedDescription":"Merged pull request \"Reinstall NuGet packages in OpenXmlPowerToolsExamples projects\" (#180) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"This commit completely removes all references to DocumentFormat.OpenXml\r\nand System.IO.Packaging, some of which pointed to a local development\r\nfolder. This commit then reinstalls the DocumentFormat.OpenXml NuGet\r\npackage v2.7.2 from nuget.org.\r\n\r\nFor .NET Framework 4.5 and earlier, DocumentFormat.OpenXml no longer\r\nuses System.IO.Packaging. For .NET Framework 4.6.1 and later,\r\nDocumentFormat.OpenXml has a dependency on System.IO.Packaging, which\r\nwill get pulled from NuGet as required."}],"ResultType":"GitHubEvent"}},"RunOn":"2017-10-06T05:31:55.0124156Z","RunDurationInMilliseconds":1659}