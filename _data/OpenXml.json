{"Data":{"Sdk":{"Events":[{"Id":"7361267775","Type":"PullRequestEvent","CreatedAt":"2018-03-11T04:55:42","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/439","RelatedDescription":"Opened pull request \"Use single property for OpenXmlPackage.ChildrenParts and PartDictionary\" (#439) at OfficeDev/Open-XML-SDK","RelatedBody":"There are two properties that point to the same instance of data. This also obsoletes a couple of methods that are redundant with simple LINQ operators that we don't need to maintain in the long run. With the next major version, we'll remove them, but for now they are marked with the ObsoleteAttribute."},{"Id":"7361187703","Type":"PullRequestEvent","CreatedAt":"2018-03-11T03:40:57","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/438","RelatedDescription":"Merged pull request \"Organize fields in OpenXmlBasePart\" (#438) at OfficeDev/Open-XML-SDK","RelatedBody":"- Uses `private protected` for `_rootElement`\r\n- Renames `_metroPackage` to `_package`"},{"Id":"7360940415","Type":"PullRequestEvent","CreatedAt":"2018-03-11T00:07:00","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/437","RelatedDescription":"Merged pull request \"Simplify app-specific target path retrieval\" (#437) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7360879009","Type":"PullRequestEvent","CreatedAt":"2018-03-10T23:19:00","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/435","RelatedDescription":"Merged pull request \"Add tests for part extension provider\" (#435) at OfficeDev/Open-XML-SDK","RelatedBody":"This also fixes the case where a content type already exists and a new part extension is added."},{"Id":"7360856827","Type":"PullRequestEvent","CreatedAt":"2018-03-10T23:03:49","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/438","RelatedDescription":"Opened pull request \"Organize fields in OpenXmlBasePart\" (#438) at OfficeDev/Open-XML-SDK","RelatedBody":"- Uses `private protected` for `_rootElement`\r\n- Renames `_metroPackage` to `_package`"},{"Id":"7360852892","Type":"PullRequestEvent","CreatedAt":"2018-03-10T23:00:58","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/437","RelatedDescription":"Opened pull request \"Simplify app-specific target path retrieval\" (#437) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7360817245","Type":"PullRequestEvent","CreatedAt":"2018-03-10T22:35:28","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/436","RelatedDescription":"Merged pull request \"Organize fields in OpenXmlPackage\" (#436) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7360762867","Type":"PullRequestEvent","CreatedAt":"2018-03-10T21:57:40","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/436","RelatedDescription":"Opened pull request \"Organize fields in OpenXmlPackage\" (#436) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7360751005","Type":"PullRequestEvent","CreatedAt":"2018-03-10T21:49:40","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/435","RelatedDescription":"Opened pull request \"Add tests for part extension provider\" (#435) at OfficeDev/Open-XML-SDK","RelatedBody":"This also fixes the case where a content type already exists and a new part extension is added."},{"Id":"7353575818","Type":"PullRequestEvent","CreatedAt":"2018-03-09T01:28:15","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/433","RelatedDescription":"Merged pull request \"Merge master into feature-office2016\" (#433) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7353159150","Type":"PullRequestEvent","CreatedAt":"2018-03-08T23:16:24","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/434","RelatedDescription":"Merged pull request \"Consolidate throw logic into FileFormatVersionExtensions\" (#434) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7351310680","Type":"PullRequestEvent","CreatedAt":"2018-03-08T16:50:57","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/434","RelatedDescription":"Opened pull request \"Consolidate throw logic into FileFormatVersionExtensions\" (#434) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7348230909","Type":"PullRequestEvent","CreatedAt":"2018-03-08T05:15:23","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/433","RelatedDescription":"Opened pull request \"Merge master into feature-office2016\" (#433) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7348210287","Type":"PullRequestEvent","CreatedAt":"2018-03-08T05:06:49","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/432","RelatedDescription":"Merged pull request \"Remove version checking to get schema data\" (#432) at OfficeDev/Open-XML-SDK","RelatedBody":"There were previously checks at multiple levels to get the schema level.\r\nThis change passes the FileFormatVersions object all the way through so\r\nthat the decision is done on whether there is a resource or not. In the\r\nfuture, this will allow new versions with minimal code churn."},{"Id":"7348150463","Type":"PullRequestEvent","CreatedAt":"2018-03-08T04:41:18","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/432","RelatedDescription":"Opened pull request \"Remove version checking to get schema data\" (#432) at OfficeDev/Open-XML-SDK","RelatedBody":"There were previously checks at multiple levels to get the schema level.\r\nThis change passes the FileFormatVersions object all the way through so\r\nthat the decision is done on whether there is a resource or not. In the\r\nfuture, this will allow new versions with minimal code churn."},{"Id":"7347401947","Type":"PullRequestEvent","CreatedAt":"2018-03-08T00:58:23","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/429","RelatedDescription":"Merged pull request \"Rename internal System.* interfaces to be in DocumentFormat.OpenXml\" (#429) at OfficeDev/Open-XML-SDK","RelatedBody":"The versions of the SDK that use .NET Framework 3.5 and 4.0 have some internal interfaces that are used internally that mimic .NET types that came in 4.5+. These had been in the same namespace as their real .NET counterparts, but this causes some issues for certain hosts.\r\n\r\nFixes #426 "}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[{"Id":"7333791977","Type":"IssuesEvent","CreatedAt":"2018-03-05T20:33:47","Actor":"XzaR90","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/215","RelatedDescription":"Opened issue \"Copy custom xml and SharePoint metadata on merging document\" (#215) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\n**Description**\r\nCopy custom XML and SharePoint metadata on merging document does not work using DocumentBuilder?\r\n\r\n\r\n**Information**\r\n\r\n- .NET Target: NET Framework 4.5.2\r\n- DocumentFormat.OpenXml Version: OpenXMLSDK-MOT 2.6.0.0\r\n\r\n**Expected**\r\n\r\nWhen I comment out if (itemList.Contains(propertyPartDoc.Root.Attribute(DS.itemID).Value)) I get the expected result.\r\n\r\n```csharp\r\n        private static void CopyCustomXml(WordprocessingDocument sourceDocument, WordprocessingDocument newDocument,\r\n            IEnumerable<XElement> newContent)\r\n        {\r\n            List<string> itemList = new List<string>();\r\n            foreach (string itemId in newContent\r\n                .Descendants(W.dataBinding)\r\n                .Select(e => (string)e.Attribute(W.storeItemID)))\r\n                if (!itemList.Contains(itemId))\r\n                    itemList.Add(itemId);\r\n\r\n            foreach (CustomXmlPart customXmlPart in sourceDocument.MainDocumentPart.CustomXmlParts)\r\n            {\r\n                OpenXmlPart propertyPart = customXmlPart\r\n                    .Parts\r\n                    .Select(p => p.OpenXmlPart)\r\n                    .Where(p => p.ContentType == \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\")\r\n                    .FirstOrDefault();\r\n\r\n                if (propertyPart != null)\r\n                {\r\n                    XDocument propertyPartDoc = propertyPart.GetXDocument();\r\n                    //if (itemList.Contains(propertyPartDoc.Root.Attribute(DS.itemID).Value))\r\n                    //{\r\n                        CustomXmlPart newPart = newDocument.MainDocumentPart.AddCustomXmlPart(customXmlPart.ContentType);\r\n                        newPart.GetXDocument().Add(customXmlPart.GetXDocument().Root);\r\n                        foreach (OpenXmlPart propPart in customXmlPart.Parts.Select(p => p.OpenXmlPart))\r\n                        {\r\n                            CustomXmlPropertiesPart newPropPart = newPart.AddNewPart<CustomXmlPropertiesPart>();\r\n                            newPropPart.GetXDocument().Add(propPart.GetXDocument().Root);\r\n                        }\r\n                    //}\r\n                }\r\n            }\r\n        }\r\n``` "},{"Id":"7332381011","Type":"IssuesEvent","CreatedAt":"2018-03-05T16:10:43","Actor":"pedro-w","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/214","RelatedDescription":"Opened issue \"Regression in OpenXmlRegex.Replace \" (#214) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"I've got a program using OpenXmlRegex.Replace to replace text 'templates' in a Word document with new values. I am getting problems with version 4.5.3.2 which weren't in 4.5.3.1. It looks like, once the document exceeds a certain size, it starts to replace characters off by one position. I've done some work to get the smallest example I can.\r\n```` C#\r\nusing System.IO;\r\nusing System.Text.RegularExpressions;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing OpenXmlPowerTools;\r\n\r\nnamespace ConsoleApp3\r\n{\r\n    class Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            var src = Path.GetFullPath(\"..\\\\..\\\\me.docx\");\r\n            var dest = Path.GetFullPath(\"..\\\\you.docx\");\r\n            File.Copy(src, dest, true);\r\n            var doc = WordprocessingDocument.Open(dest, true);\r\n            foreach (var part in doc.ContentParts())\r\n            {\r\n                var xdoc = part.GetXDocument();\r\n                var content = xdoc.Descendants(W.p);\r\n                OpenXmlRegex.Replace(content, rex, \"\", null);\r\n                part.PutXDocument();\r\n            }\r\n            doc.Save();\r\n        }\r\n        static readonly Regex rex = new Regex(\"rd\");\r\n    }\r\n}\r\n\r\n````\r\nThis program is supposed to replace all instances of 'rd' in file 'me.docx' with nothing and write the result into 'you.docx'\r\n\r\nMy input file looks like\r\n````\r\nword 1 word 2 word 3 word 4 word 5 word 6 word 7 word 8 word 9 word 10 word 11 word 12 \r\nword 13 word 14 word 15 word 16 word 17 word 18 word 19 word 20 word 21 word 22 \r\nword 23 word 24 \r\n````\r\n... down to ...\r\n````\r\nword 5991 word 5992 word 5993 word 5994 word 5995 word 5996 word 5997 word 5998 \r\nword 5999 word 6000 \r\n````\r\nAnd the output file starts off OK\r\n````\r\nwo 1 wo 2 wo 3 wo 4 wo 5 wo 6 wo 7 wo 8 wo 9 wo 10 wo 11 wo 12 wo 13 wo 14 wo 15 wo 16 wo \r\n```` \r\nbut later becomes\r\n````\r\n481 wo 482 wo 483 wo 484 wo 485 wo 486 wo 487 wo 488 wo 489 wo 490 wo 491 wd 492 wd 493 \r\nwd 494 wd 495 wd 496 wd 497 wd 498 wd 499 wd 500 wd 501 wd 502 wd 503 wd 504 wd 505 wd \r\n````\r\nand stays like that to the end.\r\nI've tried different combinations of text, regex and replacement but there is no obvious way to calculate when it will go wrong.\r\n\r\nHowever if I downgrade my NuGet packages to 4.5.3.1 it works OK. It seems to be independent of the version of `DocumentFormat.OpenXml` used, I can upgrade that to 2.8.1 (from 2.7.1/2.7.2) with no effect.\r\n\r\nI am happy to do some more investigation but I found it difficult to work out which revision in git corresponds to which version in NuGet as there are no git tags.\r\n\r\nI am using Visual Studio 2017, .NET 4.6.2"},{"Id":"7324436741","Type":"PullRequestEvent","CreatedAt":"2018-03-02T22:43:00","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/50","RelatedDescription":"Closed pull request \"[Fix] Order of sources influences insertId outcome\" (#50) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"When doing a BuildDocument, Source objects without Id should be processed first, to ensure Source object with insertId can be inserted.\n\nI do an Orderby to ensure the 'optimized' order of execution.\n"},{"Id":"7324426127","Type":"PullRequestEvent","CreatedAt":"2018-03-02T22:39:58","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/213","RelatedDescription":"Merged pull request \"Add AppVeyor badge\" (#213) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""},{"Id":"7324425337","Type":"PullRequestEvent","CreatedAt":"2018-03-02T22:39:44","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/213","RelatedDescription":"Opened pull request \"Add AppVeyor badge\" (#213) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""},{"Id":"7324418905","Type":"PullRequestEvent","CreatedAt":"2018-03-02T22:37:55","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/212","RelatedDescription":"Merged pull request \"Add support for appveyor\" (#212) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""},{"Id":"7324341706","Type":"PullRequestEvent","CreatedAt":"2018-03-02T22:16:46","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/212","RelatedDescription":null,"RelatedBody":""},{"Id":"7324341591","Type":"PullRequestEvent","CreatedAt":"2018-03-02T22:16:44","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/212","RelatedDescription":"Closed pull request \"Add support for appveyor\" (#212) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""}],"ResultType":"GitHubEvent"}},"RunOn":"2018-03-11T05:30:28.1226881Z","RunDurationInMilliseconds":1888}