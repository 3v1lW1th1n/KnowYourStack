{"Data":{"GitHub":{"Issues":[{"Id":"539070426","IsPullRequest":true,"CreatedAt":"2019-12-18T23:56:36","Actor":"hughbe","Number":"2511","RawContent":null,"Title":"Add ToolStrip tests and related tests","State":"closed","Body":"## Proposed Changes\r\n- Add ToolStrip tests and related tests\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2511)","Url":"https://github.com/dotnet/winforms/pull/2511","RelatedDescription":"Closed or merged PR \"Add ToolStrip tests and related tests\" (#2511)"},{"Id":"539567022","IsPullRequest":true,"CreatedAt":"2019-12-18T23:50:19","Actor":"hughbe","Number":"2519","RawContent":null,"Title":"Don't force create handle in TabPageCollectionTests.Clear","State":"closed","Body":"## Proposed Changes\r\n- Don't force create handle in TabPageCollectionTests.Clear\r\n\r\nFixes #2275\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2519)","Url":"https://github.com/dotnet/winforms/pull/2519","RelatedDescription":"Closed or merged PR \"Don't force create handle in TabPageCollectionTests.Clear\" (#2519)"},{"Id":"539568887","IsPullRequest":true,"CreatedAt":"2019-12-18T23:48:24","Actor":"hughbe","Number":"2520","RawContent":null,"Title":"Correct handle check in VisualStyleRenderer.DrawParentBackground","State":"closed","Body":"- Should be `IsHandleCreated`\r\n\r\nFixes #2219\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2520)","Url":"https://github.com/dotnet/winforms/pull/2520","RelatedDescription":"Closed or merged PR \"Correct handle check in VisualStyleRenderer.DrawParentBackground\" (#2520)"},{"Id":"539172544","IsPullRequest":true,"CreatedAt":"2019-12-18T23:26:33","Actor":"hughbe","Number":"2513","RawContent":null,"Title":"Fix some coverage gaps in CommonDialog","State":"closed","Body":"## Proposed Changes\r\n- Fix some coverage gaps in CommonDialog\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2513)","Url":"https://github.com/dotnet/winforms/pull/2513","RelatedDescription":"Closed or merged PR \"Fix some coverage gaps in CommonDialog\" (#2513)"},{"Id":"539578566","IsPullRequest":true,"CreatedAt":"2019-12-18T23:24:49","Actor":"hughbe","Number":"2521","RawContent":null,"Title":"Convert Application.ThreadException to IClassFixture","State":"closed","Body":"Should we close https://github.com/dotnet/winforms/issues/2234 now ?\r\n\r\nCredits to @weltkante \n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2521)","Url":"https://github.com/dotnet/winforms/pull/2521","RelatedDescription":"Closed or merged PR \"Convert Application.ThreadException to IClassFixture\" (#2521)"},{"Id":"539097548","IsPullRequest":true,"CreatedAt":"2019-12-18T23:18:33","Actor":"hughbe","Number":"2512","RawContent":null,"Title":"Don't create Handle in MonthCalendar.OnHandleCreated","State":"closed","Body":"## Proposed Changes\r\n- Don't create Handle in MonthCalendar.OnHandleCreate (#2235)\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2512)","Url":"https://github.com/dotnet/winforms/pull/2512","RelatedDescription":"Closed or merged PR \"Don't create Handle in MonthCalendar.OnHandleCreated\" (#2512)"},{"Id":"539655395","IsPullRequest":true,"CreatedAt":"2019-12-18T23:16:43","Actor":"hughbe","Number":"2526","RawContent":null,"Title":"Add more ColumnHeader tests","State":"closed","Body":"## Proposed Changes\r\n- Add ColumnHeader tests with an extra focus on making sure #1913 does not regress things\r\n\r\n(Sort of) relies on #1913 and #2521 \n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2526)","Url":"https://github.com/dotnet/winforms/pull/2526","RelatedDescription":"Closed or merged PR \"Add more ColumnHeader tests\" (#2526)"},{"Id":"539344399","IsPullRequest":true,"CreatedAt":"2019-12-18T22:27:48","Actor":"hughbe","Number":"2516","RawContent":null,"Title":"Cleanup IVSMDPerPropertyBrowsing interface","State":"closed","Body":"## Proposed Changes\r\n- Cleanup IVSMDPerPropertyBrowsing interface\r\n\r\nSee https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.designer.interfaces.ivsmdperpropertybrowsing?view=visualstudiosdk-2017\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2516)","Url":"https://github.com/dotnet/winforms/pull/2516","RelatedDescription":"Closed or merged PR \"Cleanup IVSMDPerPropertyBrowsing interface\" (#2516)"},{"Id":"539666766","IsPullRequest":true,"CreatedAt":"2019-12-18T13:16:50","Actor":"dotnet-maestro[bot]","Number":"2528","RawContent":null,"Title":"[master] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n## From https://github.com/dotnet/arcade\r\n- **Build**: 20191217.1\r\n- **Date Produced**: 12/17/2019 3:10 PM\r\n- **Commit**: 66175ebd3756697a3ca515e16cd5ffddc30582cd\r\n- **Branch**: refs/heads/master\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions** -> 5.0.0-beta.19617.1\r\n  - **Microsoft.DotNet.Arcade.Sdk** -> 5.0.0-beta.19617.1\r\n  - **Microsoft.DotNet.GenFacades** -> 5.0.0-beta.19617.1\r\n  - **Microsoft.DotNet.Helix.Sdk** -> 5.0.0-beta.19617.1\r\n\r\n[marker]: <> (End:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2528)","Url":"https://github.com/dotnet/winforms/pull/2528","RelatedDescription":"Closed or merged PR \"[master] Update dependencies from dotnet/arcade\" (#2528)"},{"Id":"539658200","IsPullRequest":true,"CreatedAt":"2019-12-18T12:43:15","Actor":"hughbe","Number":"2527","RawContent":null,"Title":"WIP: Fix ImageList stack overflows","State":"open","Body":"Fixes #2522\r\n\r\nTests to come\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2527)","Url":"https://github.com/dotnet/winforms/pull/2527","RelatedDescription":"Open PR \"WIP: Fix ImageList stack overflows\" (#2527)"},{"Id":"539637962","IsPullRequest":false,"CreatedAt":"2019-12-18T11:59:41","Actor":"Thea-Zhao","Number":"2525","RawContent":null,"Title":"The text and image of the ToolStripMenutems cannot be shown completely","State":"open","Body":"* .NET Core Version: (.NET Core 5.0.100-alpha1-015949)\r\n* Have you experienced this same bug with .NET Framework?:No\r\n\r\n<!-- Read https://github.com/dotnet/winforms/blob/master/Documentation/issue-guide.md -->\r\n\r\n**Problem description:**\r\nThe text and image of the ToolStripMenuItems cannot be shown completely.\r\n\r\n**More Info:**\r\n1. This is a regression issue, it's not reproducing when targeting .NET Core 3.1.\r\n2. This issue also cannot reproduce with Framework project.\r\n3. This issue affected ContextMenuStrip, MenuStrip, StatusStrip, ToolStrip, BindingNavigator controls.\r\n\r\n\r\n**Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nThe text and image of the ToolStripMenuItems shows not correctly.\r\n.NET Core 5.0 screenshot\r\n![Issue5-withprivate](https://user-images.githubusercontent.com/53589182/71084395-21128f00-21d0-11ea-9e7b-4557e85fa47e.png)\r\n\r\n**Expected behavior:**\r\nThe  text and image should be displayed correctly and completely.\r\n.NET Core 3.1 screenshot\r\n![Issue5-withoutprivate](https://user-images.githubusercontent.com/53589182/71084635-b2820100-21d0-11ea-93c6-e3be6f951796.png)\r\n\r\n**Minimal repro:**\r\n1. Run attached app.\r\n[ItemDisplayIssue.zip](https://github.com/dotnet/winforms/files/3978260/ItemDisplayIssue.zip)\r\n2. Observe the display of the ToolStripMenuItems.","Url":"https://github.com/dotnet/winforms/issues/2525","RelatedDescription":"Open issue \"The text and image of the ToolStripMenutems cannot be shown completely\" (#2525)"},{"Id":"539633523","IsPullRequest":false,"CreatedAt":"2019-12-18T11:50:23","Actor":"Thea-Zhao","Number":"2524","RawContent":null,"Title":"The back color of the text cannot be set successfully","State":"open","Body":"* .NET Core Version: (.NET Core 5.0.100-alpha1-015949)\r\n* Have you experienced this same bug with .NET Framework?:No\r\n\r\n<!-- Read https://github.com/dotnet/winforms/blob/master/Documentation/issue-guide.md -->\r\n\r\n**Problem description:**\r\nThe back color of the text cannot be set successfully.\r\n\r\n**More Info:**\r\n1. This is a regression issue, it's not reproducing when targeting .NET Core 3.1.\r\n2. This issue also cannot reproduce with Framework project.\r\n\r\n**Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nNo expected back color shown.\r\n.NET Core 5.0 screenshot\r\n![BackColorIssue-withprivate](https://user-images.githubusercontent.com/53589182/71083833-e8be8100-21ce-11ea-8254-324d0692553b.png)\r\n\r\n**Expected behavior:**\r\nThe text should be set back color successfully.\r\n.NET Core 3.1 screenshot\r\n![BackColorIssue-withoutprivate](https://user-images.githubusercontent.com/53589182/71083861-f8d66080-21ce-11ea-9ac9-139ea71e62cb.png)\r\n\r\n**Minimal repro:**\r\n1. Run attached app.\r\n[BackcolorIssue.zip](https://github.com/dotnet/winforms/files/3978216/BackcolorIssue.zip)\r\n2. Observe the Text display.","Url":"https://github.com/dotnet/winforms/issues/2524","RelatedDescription":"Open issue \"The back color of the text cannot be set successfully\" (#2524)"},{"Id":"539632048","IsPullRequest":false,"CreatedAt":"2019-12-18T11:47:27","Actor":"Jessie-Zhang01","Number":"2523","RawContent":null,"Title":"The text of the selected drop-down list item is invisible in PropertyGrid","State":"open","Body":"**.NET Core Version:** .NET Core 5.0.100-alpha1-15949 from Release branch + the VSIX Inserted into Dev16 16.5.0 Preview 2.0 [29617.90.master]\r\n**Have you experienced this same bug with .NET Framework?:** No\r\n\r\n**More info:**\r\n1.\tThis issue cannot reproduce when the application target to 3.0 or 3.1.\r\n2.\tThis issue cannot reproduce in design time.\r\n \r\n**Repro Steps:**\r\n1.\tOpen the attached ‘WindowsFormsApp17’ .NET Core app in VS.\r\n2.\tBuild and run this application, select a drop-down and expend it.\r\n \r\n[WindowsFormsApp17.zip](https://github.com/dotnet/winforms/files/3978229/WindowsFormsApp17.zip)\r\n\r\n**Actual Result:**\r\nThe text of the selected drop-down list item is invisible.\r\n![image](https://user-images.githubusercontent.com/45864649/71083636-75b50a80-21ce-11ea-8395-5fd6fbc4327a.png)\r\n\r\n**Expect Result:** \r\nThe selected drop-down list item should display its own text.\r\n![image](https://user-images.githubusercontent.com/45864649/71083647-7a79be80-21ce-11ea-9f65-34fbae704f03.png)","Url":"https://github.com/dotnet/winforms/issues/2523","RelatedDescription":"Open issue \"The text of the selected drop-down list item is invisible in PropertyGrid\" (#2523)"},{"Id":"539597055","IsPullRequest":false,"CreatedAt":"2019-12-18T10:37:48","Actor":"Vino-Wang","Number":"2522","RawContent":null,"Title":"An exception pops up when executing these methods: ImageList.Images.Clear() and ListViewItem.ImageList.Image.Clear()","State":"open","Body":"* .NET Core Version: (.NET Core 5.0 5.0.100.15949 5.0.0-alpha.1.19617.3 )\r\n* Have you experienced this same bug with .NET Framework?: No\r\n\r\n<!-- Read https://github.com/dotnet/winforms/blob/master/Documentation/issue-guide.md -->\r\n**More Info**\r\n1. This issue cannot reproduce with Framework app.\r\n2. This issue cannot reproduce when targeting .NET Core 3.1.\r\n\r\n**Problem description:**\r\nAn exception pops up when the cases implement the following affected methods: ImageList.Images.Clear() and ListViewItem.ImageList.Image.Clear()\r\n\r\n**Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nAn exception pops up.\r\n![Actual](https://user-images.githubusercontent.com/18568603/71078995-5ebdea80-21c5-11ea-8024-6792c37e2e46.PNG)\r\n\r\n**Expected behavior:**\r\nThere should no any exception popping up.\r\n\r\n**Minimal repro:**\r\n1.\tRun the attached project. \r\n[ImageClearIssue.zip](https://github.com/dotnet/winforms/files/3977900/ImageClearIssue.zip)\r\n\r\n2.\tClick the any of the buttons on the form, then wait seconds.\r\n","Url":"https://github.com/dotnet/winforms/issues/2522","RelatedDescription":"Open issue \"An exception pops up when executing these methods: ImageList.Images.Clear() and ListViewItem.ImageList.Image.Clear()\" (#2522)"},{"Id":"539500694","IsPullRequest":true,"CreatedAt":"2019-12-18T07:14:47","Actor":"RussKie","Number":"2518","RawContent":null,"Title":"Solution restructure","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\n\r\n## Proposed changes\r\n\r\n- Move all interops and required common definitions into a dedicated project System.Windows.Forms.Primitives. This will allow simpler maintenance of shared types definitions.\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- None, this is an infra change\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2518)","Url":"https://github.com/dotnet/winforms/pull/2518","RelatedDescription":"Open PR \"Solution restructure\" (#2518)"},{"Id":"539369572","IsPullRequest":true,"CreatedAt":"2019-12-18T04:54:18","Actor":"Tanya-Solyanik","Number":"2517","RawContent":null,"Title":"Added a pointer to Accessibility insights to the testing doc.","State":"closed","Body":"\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2517)","Url":"https://github.com/dotnet/winforms/pull/2517","RelatedDescription":"Closed or merged PR \"Added a pointer to Accessibility insights to the testing doc.\" (#2517)"},{"Id":"539285157","IsPullRequest":true,"CreatedAt":"2019-12-17T20:10:59","Actor":"kpreisser","Number":"2515","RawContent":null,"Title":"Fall back to the legacy file/folder dialog on COMException","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #2506\r\n\r\n\r\n## Proposed changes\r\n\r\n- When creating an instance of the `NativeFileOpenDialog` or `NativeFileSaveDialog` fails with a `COMException`, fall back to the legacy file dialog instead of letting the exception bubble up to the caller.\r\n\r\nNote: I'm not sure if there's another way to check if the COM object will be available without actually throwing (and catching) a `COMException`.\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- When using the [`OpenFileDialog`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.openfiledialog?view=netcore-3.1), [`SaveFileDialog`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.savefiledialog?view=netcore-3.1), or [`FolderBrowserDialog`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.folderbrowserdialog?view=netcore-3.1) (with **`AutoUpgradeEnabled=true`**) on a Windows system lacking the necessary COM components (e.g. Windows Server Core), customers will experience the legacy file/folder dialog being shown when calling `ShowDialog()`, rather than a `COMException` being thrown preventing the dialog from working.\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n-\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\n![grafik](https://user-images.githubusercontent.com/13289184/71029761-58216b80-2110-11ea-8b27-0e4f1f38657a.png)\r\n\r\n\r\n### After\r\n\r\n![grafik](https://user-images.githubusercontent.com/13289184/71029872-99198000-2110-11ea-8ae7-de4783a9d5cf.png)\r\n\r\n![grafik](https://user-images.githubusercontent.com/13289184/71029904-a6cf0580-2110-11ea-8807-607ddd2d6e10.png)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manual testing on Windows Server 2019 (installed as Server Core) as described in #2506, as well as on Windows 10 to verify that the Vista dialogs are still shown\r\n\r\n<!--\r\n     Microsoft prioritizes making our products accessible. \r\n     WinForms has a key role in allowing developers to create accessible apps. \r\n     \r\n     When submitting a change which impacts UI in any way, including adding new UI or\r\n     modifying existing controls the developer needs to run the Accessibility Insights\r\n     tool (https://accessibilityinsights.io/) and verify that there are no changes or\r\n     regressions. \r\n     \r\n     The developer should run the Fast Pass over the impacted control(s) and provide\r\n     a snapshot of the passing results along with before/after snapshots of the UI.\r\n     More info: (https://accessibilityinsights.io/docs/en/web/getstarted/fastpass)\r\n  -->\r\n\r\n\r\n \r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n.NET Core SDK (reflecting any global.json):\r\n Version:   5.0.100-alpha1-015777\r\n Commit:    cea32db3f2\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.17134\r\n OS Platform: Windows\r\n RID:         win10-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\5.0.100-alpha1-015777\\\r\n\r\nHost (useful for support):\r\n  Version: 5.0.0-alpha.1.19564.1\r\n  Commit:  c77948d92a\r\n\r\n.NET Core SDKs installed:\r\n  3.1.100 [C:\\Program Files\\dotnet\\sdk]\r\n  5.0.100-alpha1-015777 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2515)","Url":"https://github.com/dotnet/winforms/pull/2515","RelatedDescription":"Open PR \"Fall back to the legacy file/folder dialog on COMException\" (#2515)"},{"Id":"539277288","IsPullRequest":true,"CreatedAt":"2019-12-17T19:53:48","Actor":"hughbe","Number":"2514","RawContent":null,"Title":"Add TrackBar tests and for related components","State":"open","Body":"## Proposed Changes\r\n- Add TrackBar tests and for related components\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2514)","Url":"https://github.com/dotnet/winforms/pull/2514","RelatedDescription":"Open PR \"Add TrackBar tests and for related components\" (#2514)"},{"Id":"539052265","IsPullRequest":true,"CreatedAt":"2019-12-17T13:16:52","Actor":"dotnet-maestro[bot]","Number":"2510","RawContent":null,"Title":"[master] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n## From https://github.com/dotnet/arcade\r\n- **Build**: 20191216.4\r\n- **Date Produced**: 12/16/2019 9:51 PM\r\n- **Commit**: 4736ddca60a4040447b450437cf3767c9045edc0\r\n- **Branch**: refs/heads/master\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions** -> 5.0.0-beta.19616.4\r\n  - **Microsoft.DotNet.Arcade.Sdk** -> 5.0.0-beta.19616.4\r\n  - **Microsoft.DotNet.GenFacades** -> 5.0.0-beta.19616.4\r\n  - **Microsoft.DotNet.Helix.Sdk** -> 5.0.0-beta.19616.4\r\n\r\n[marker]: <> (End:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2510)","Url":"https://github.com/dotnet/winforms/pull/2510","RelatedDescription":"Closed or merged PR \"[master] Update dependencies from dotnet/arcade\" (#2510)"},{"Id":"538398650","IsPullRequest":true,"CreatedAt":"2019-12-17T00:17:18","Actor":"hughbe","Number":"2508","RawContent":null,"Title":"Remove always undefined SELECTEDCHANGED","State":"closed","Body":"## Proposed Changes\r\n- Remove always undefined SELECTEDCHANGED\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2508)","Url":"https://github.com/dotnet/winforms/pull/2508","RelatedDescription":"Closed or merged PR \"Remove always undefined SELECTEDCHANGED\" (#2508)"},{"Id":"538721871","IsPullRequest":true,"CreatedAt":"2019-12-16T23:53:06","Actor":"hughbe","Number":"2509","RawContent":null,"Title":"Add ToolStripItem tests and tests for related components","State":"closed","Body":"## Proposed Changes\r\n- Add ToolStripItem tests and tests for related components\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2509)","Url":"https://github.com/dotnet/winforms/pull/2509","RelatedDescription":"Closed or merged PR \"Add ToolStripItem tests and tests for related components\" (#2509)"},{"Id":"538398392","IsPullRequest":true,"CreatedAt":"2019-12-16T13:27:05","Actor":"dotnet-maestro[bot]","Number":"2507","RawContent":null,"Title":"[master] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n## From https://github.com/dotnet/arcade\r\n- **Build**: 20191215.1\r\n- **Date Produced**: 12/15/2019 2:03 PM\r\n- **Commit**: 77698ebba1ab096ad9580a5d9ebefe0499ba00ce\r\n- **Branch**: refs/heads/master\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions** -> 5.0.0-beta.19615.1\r\n  - **Microsoft.DotNet.Arcade.Sdk** -> 5.0.0-beta.19615.1\r\n  - **Microsoft.DotNet.GenFacades** -> 5.0.0-beta.19615.1\r\n  - **Microsoft.DotNet.Helix.Sdk** -> 5.0.0-beta.19615.1\r\n\r\n[marker]: <> (End:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2507)","Url":"https://github.com/dotnet/winforms/pull/2507","RelatedDescription":"Closed or merged PR \"[master] Update dependencies from dotnet/arcade\" (#2507)"},{"Id":"537901095","IsPullRequest":false,"CreatedAt":"2019-12-16T07:36:43","Actor":"199621616","Number":"2503","RawContent":null,"Title":"迁移到.NetCore3.1后窗口变形严重","State":"closed","Body":"将基于.Net Framework 4.6.1的WinForm迁移到.Net Core 3.1后窗口变形严重。是我错过了什么，还是.Net Core 3.1本是如此？需要我们根据.Net Core 3.1再调整，还是需要你们修复？\r\n下图左右两个窗口差距很大，代码没有任何变动。\r\n![image](https://user-images.githubusercontent.com/25498672/70848165-61a89a80-1ea8-11ea-9037-ccf53c4c399a.png)\r\n","Url":"https://github.com/dotnet/winforms/issues/2503","RelatedDescription":"Closed issue \"迁移到.NetCore3.1后窗口变形严重\" (#2503)"},{"Id":"538087824","IsPullRequest":false,"CreatedAt":"2019-12-15T18:28:24","Actor":"kpreisser","Number":"2506","RawContent":null,"Title":"FileDialog/FolderBrowserDialog should fall back to legacy dialog on COMException","State":"open","Body":"* .NET Core Version: `master` (7dee30995829711ac3a486f672cede1171ab4eb1)\r\n* Have you experienced this same bug with .NET Framework?: Yes\r\n\r\n<!-- Read https://github.com/dotnet/winforms/blob/master/Documentation/issue-guide.md -->\r\n\r\n**Problem description:**\r\n\r\nWhen [`FileDialog.AutoUpgradeEnabled`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.filedialog.autoupgradeenabled?view=netcore-3.1)/[`FolderBrowserDialog.AutoUpgradeEnabled`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.folderbrowserdialog.autoupgradeenabled?view=netcore-3.1) is `true` (the default), the newer COM-based Vista File Dialog will be shown instead of the legacy file dialog.\r\n\r\nHowever, on Windows Server that was installed using the \"Server Core\" option, these COM components may not available. While Server Core normally isn't suited to run GUI applications, you can install the [**Server Core App Compatibility Feature on Demand (FOD)**](https://docs.microsoft.com/en-us/windows-server/get-started-19/install-fod-19) package that improves compatibility for GUI applications by installing additional components, including `explorer.exe` (as file browser). E.g., SQL Server Management Studio is fully functional on Server Core with the App Compatibility FOD installed.\r\n\r\nWhile that package normally also installs the COM components required to show the Vista file dialog, in some cases (e.g. after installing certain Windows Updates) these components can become unavailable again, and the Vista File Dialog will no longer work. \r\n\r\n**Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nWhen the COM components required for the Vista file dialog are not available, calling `OpenFileDialog.ShowDialog()` results in a **`COMException`** (`CLASS_E_CLASSNOTAVAILABLE`):\r\n\r\n```\r\nSystem.Runtime.InteropServices.COMException (0x80040111): Creating an instance of the COM component with CLSID {DC1C5A9C-E88A-4DDE-A5A1-60F82A20AEF7} from the IClassFactory failed due to the following error: 80040111 ClassFactory cannot supply requested class (0x80040111 (CLASS_E_CLASSNOTAVAILABLE)).\r\n   at System.Windows.Forms.OpenFileDialog.CreateVistaDialog()\r\n   at System.Windows.Forms.FileDialog.RunDialogVista(IntPtr hWndOwner)\r\n   at System.Windows.Forms.FileDialog.RunDialog(IntPtr hWndOwner)\r\n   at System.Windows.Forms.CommonDialog.ShowDialog(IWin32Window owner)\r\n   at System.Windows.Forms.CommonDialog.ShowDialog()\r\n```\r\n\r\nA similar stack occurs for `FolderBrowserDialog.ShowDialog()`:\r\n```\r\nSystem.Runtime.InteropServices.COMException (0x80040111): Creating an instance of the COM component with CLSID {DC1C5A9C-E88A-4DDE-A5A1-60F82A20AEF7} from the IClassFactory failed due to the following error: 80040111 ClassFactory cannot supply requested class (0x80040111 (CLASS_E_CLASSNOTAVAILABLE)).\r\n   at System.Windows.Forms.FolderBrowserDialog.RunDialogVista(IntPtr owner)\r\n   at System.Windows.Forms.FolderBrowserDialog.RunDialog(IntPtr hWndOwner\r\n   at System.Windows.Forms.CommonDialog.ShowDialog(IWin32Window owner)\r\n   at System.Windows.Forms.CommonDialog.ShowDialog()\r\n```\r\n\r\n\r\n**Expected behavior:**\r\nWhen instantiating the COM object fails, I think the dialog should automatically fall back to the legacy file dialog, which seems to be done by most native applications like `notepad.exe` (see repro steps).\r\nThis will allow WinForms applications using a `FileDialog` or `FolderBrowserDialog` to work correctly on Windows Server Core with App Compatibility FOD installed, instead of crashing due to the `COMException`.\r\n\r\n\r\n**Minimal repro:**\r\n* Install Windows Server 2019 (using ISO image from [MS Evaluation Center](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2019)), using option `Windows Server 2019 Standard Evaluation` (not with \"Desktop Experience\").\r\n* After installation is finished, install the [Server Core App Compatibility FOD](https://docs.microsoft.com/en-us/windows-server/get-started-19/install-fod-19) in Powershell with `Add-WindowsCapability -Online -Name ServerCore.AppCompatibility~~~~0.0.1.0`, and then restart the machine.\r\n* On another machine, create a new WinForms app with `dotnet new winforms` and use the following code in `Program.cs`:\r\n```c#\r\nusing System;\r\nusing System.Windows.Forms;\r\n\r\nclass Program\r\n{\r\n    [STAThread]\r\n    static void Main()\r\n    {\r\n        Application.EnableVisualStyles();\r\n        Application.SetCompatibleTextRenderingDefault(false);\r\n\r\n        var dialog = new OpenFileDialog();\r\n        dialog.ShowDialog();\r\n    }\r\n}\r\n```\r\n* Publish the app with `dotnet publish -f netcoreapp5.0 -r win-x64`.\r\n* Copy the published app to the Windows Server machine and run it.\r\n* Notice the file dialog is correctly shown using the Vista file dialog. Also, when you start `notepad.exe` and select `File`->`Open`, it shows the Vista file dialog:\r\n![grafik](https://user-images.githubusercontent.com/13289184/70863732-5b1f2f00-1f4b-11ea-9486-b974fc86f084.png)\r\n* Now download and install [`2019-12 Cumulative Update for Windows Server 2019 for x64-based Systems (KB4530715)`](https://www.catalog.update.microsoft.com/Search.aspx?q=KB4530715), and restart the machine.\r\n* Run the app again. Notice it fails with a **`COMException`** (see stacktrace above).\r\n* When running `notepad.exe` and selecting `File`->`Open`, you can see that the legacy file dialog is shown:\r\n![grafik](https://user-images.githubusercontent.com/13289184/70863741-8d309100-1f4b-11ea-92cb-b5a6d9cda9cc.png)\r\n\r\n**Workaround**\r\n\r\nYou can work around the issue by catching `COMException` and disabling `AutoUpgradeEnabled`:\r\n```c#\r\n        try\r\n        {\r\n            dialog.ShowDialog();\r\n        }\r\n        catch (COMException) when (dialog.AutoUpgradeEnabled)\r\n        {\r\n            dialog.AutoUpgradeEnabled = false;\r\n            try\r\n            {\r\n                dialog.ShowDialog();\r\n            }\r\n            finally\r\n            {\r\n                dialog.AutoUpgradeEnabled = true;\r\n            }\r\n        }\r\n```\r\n\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/2506","RelatedDescription":"Open issue \"FileDialog/FolderBrowserDialog should fall back to legacy dialog on COMException\" (#2506)"},{"Id":"538048101","IsPullRequest":true,"CreatedAt":"2019-12-15T13:47:07","Actor":"dotnet-maestro[bot]","Number":"2505","RawContent":null,"Title":"[master] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n## From https://github.com/dotnet/arcade\r\n- **Build**: 20191214.1\r\n- **Date Produced**: 12/14/2019 1:54 PM\r\n- **Commit**: 64e95735b49d37b6cf908cfa5228ff65bee6dfff\r\n- **Branch**: refs/heads/master\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions** -> 5.0.0-beta.19614.1\r\n  - **Microsoft.DotNet.Arcade.Sdk** -> 5.0.0-beta.19614.1\r\n  - **Microsoft.DotNet.GenFacades** -> 5.0.0-beta.19614.1\r\n  - **Microsoft.DotNet.Helix.Sdk** -> 5.0.0-beta.19614.1\r\n\r\n[marker]: <> (End:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2505)","Url":"https://github.com/dotnet/winforms/pull/2505","RelatedDescription":"Closed or merged PR \"[master] Update dependencies from dotnet/arcade\" (#2505)"},{"Id":"537910949","IsPullRequest":true,"CreatedAt":"2019-12-14T13:16:53","Actor":"dotnet-maestro[bot]","Number":"2504","RawContent":null,"Title":"[master] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n## From https://github.com/dotnet/arcade\r\n- **Build**: 20191213.1\r\n- **Date Produced**: 12/13/2019 3:35 PM\r\n- **Commit**: acd18a717ab18e484addef602e2af2b2bc4c4bd1\r\n- **Branch**: refs/heads/master\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions** -> 5.0.0-beta.19613.1\r\n  - **Microsoft.DotNet.Arcade.Sdk** -> 5.0.0-beta.19613.1\r\n  - **Microsoft.DotNet.GenFacades** -> 5.0.0-beta.19613.1\r\n  - **Microsoft.DotNet.Helix.Sdk** -> 5.0.0-beta.19613.1\r\n\r\n[marker]: <> (End:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2504)","Url":"https://github.com/dotnet/winforms/pull/2504","RelatedDescription":"Closed or merged PR \"[master] Update dependencies from dotnet/arcade\" (#2504)"},{"Id":"537538441","IsPullRequest":true,"CreatedAt":"2019-12-13T13:16:56","Actor":"dotnet-maestro[bot]","Number":"2502","RawContent":null,"Title":"[master] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n## From https://github.com/dotnet/arcade\r\n- **Build**: 20191212.1\r\n- **Date Produced**: 12/12/2019 2:36 PM\r\n- **Commit**: b590bede6a5244ee732c63c99f725728cabbda48\r\n- **Branch**: refs/heads/master\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions** -> 5.0.0-beta.19612.1\r\n  - **Microsoft.DotNet.Arcade.Sdk** -> 5.0.0-beta.19612.1\r\n  - **Microsoft.DotNet.GenFacades** -> 5.0.0-beta.19612.1\r\n  - **Microsoft.DotNet.Helix.Sdk** -> 5.0.0-beta.19612.1\r\n\r\n[marker]: <> (End:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2502)","Url":"https://github.com/dotnet/winforms/pull/2502","RelatedDescription":"Closed or merged PR \"[master] Update dependencies from dotnet/arcade\" (#2502)"},{"Id":"537289467","IsPullRequest":false,"CreatedAt":"2019-12-13T00:45:58","Actor":"paul1956","Number":"2501","RawContent":null,"Title":"Read me for Visual Studio and Core releases do not highlight breaking changes","State":"open","Body":"There are (breaking) changes between Framework and Core that are hard to discover. Until today I did not know there was a GitHub documentation: breaking tag with some of that information. While this is great for details this is terrible for discovery. So far I have found out Core has new default font, there are significant and great changes in FolderDialogBrowser, DataGridView Heading have different behavior, Version 16.5.0 Preview 1.0 designer supports VB and this is just to name a few. NONE are bugs IMHO, they are improvements that people need to know about and in some cases before installing and not tripped on.","Url":"https://github.com/dotnet/winforms/issues/2501","RelatedDescription":"Open issue \"Read me for Visual Studio and Core releases do not highlight breaking changes\" (#2501)"},{"Id":"536964625","IsPullRequest":true,"CreatedAt":"2019-12-12T13:17:00","Actor":"dotnet-maestro[bot]","Number":"2500","RawContent":null,"Title":"[master] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n## From https://github.com/dotnet/arcade\r\n- **Build**: 20191211.6\r\n- **Date Produced**: 12/11/2019 10:53 PM\r\n- **Commit**: 71a91bbb3c49bad2f1e7f2c7f28b32c5c0efc9e5\r\n- **Branch**: refs/heads/master\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions** -> 5.0.0-beta.19611.6\r\n  - **Microsoft.DotNet.Arcade.Sdk** -> 5.0.0-beta.19611.6\r\n  - **Microsoft.DotNet.GenFacades** -> 5.0.0-beta.19611.6\r\n  - **Microsoft.DotNet.Helix.Sdk** -> 5.0.0-beta.19611.6\r\n\r\n[marker]: <> (End:4d0c844d-0758-4fc5-c1ad-08d6354da8a8)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2500)","Url":"https://github.com/dotnet/winforms/pull/2500","RelatedDescription":"Closed or merged PR \"[master] Update dependencies from dotnet/arcade\" (#2500)"},{"Id":"536399494","IsPullRequest":true,"CreatedAt":"2019-12-11T14:17:55","Actor":"hughbe","Number":"2499","RawContent":null,"Title":"Fix DivideByZeroException in MonthCalendar","State":"open","Body":"## Proposed Changes\r\n- If `SingleMonthSize` is a certain size, (e.g. `new Size(6, 6)`) then a `DivideByZeroException` is thrown.\r\n- Fix this by avoiding the `DivideByZeroException` by not checking for this case and not dividing by zero\r\n\r\nExtracted from https://github.com/dotnet/winforms/pull/2482\n\n###### Microsoft Reviewers: [Open in CodeFlow](http://wpcp.azurewebsites.net/CodeFlowProtocolProxy2.php?pullrequest=https://github.com/dotnet/winforms/pull/2499)","Url":"https://github.com/dotnet/winforms/pull/2499","RelatedDescription":"Open PR \"Fix DivideByZeroException in MonthCalendar\" (#2499)"}],"ResultType":"GitHubIssue"}},"RunOn":"2019-12-19T05:30:57.2869406Z","RunDurationInMilliseconds":886}