{"Data":{"Sdk":{"Events":[{"Id":"11842953612","Type":"IssuesEvent","CreatedAt":"2020-03-24T00:41:01","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/645","RelatedDescription":"Closed issue \"Embedded documents with images breaks \"Save As\" on Word for Mac\" (#645) at OfficeDev/Open-XML-SDK","RelatedBody":"Is this a:\r\n- [x] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n**Description**\r\n\r\nUsing OpenXML, appending a word document with embedded images into another word document using `AddAlternativeFormatImportPart(AlternativeFormatImportPartType.WordprocessingML, altChunkId)` causes an issue where the user can not \"Save\" or \"Save As\" when altering the content in Word for Mac.\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Framework, .NET Core 3\r\n- DocumentFormat.OpenXml Version: 2.9.1\r\n\r\n**Repro**\r\n\r\n1. Create a new Console App in Visual Studio on Mac\r\n1. Add a folder to the top level called \"Docs\"\r\n1. Download the Nuget dependency DocumentFormat.OpenXml\r\n1. Create a new word doc named \"test-source.docx\"\r\n    1. Put some test text in there, doesn't matter what\r\n    1. Add the document to the solution in \"Docs\" folder\r\n    1. Change the property to \"Copy always\"\r\n1. Create a new word doc named \"test-append.docx\" (the embedded word doc)\r\n    1.  Put in some test text at the top\r\n    1. Copy over a jpg of your choice. The image type I used to reproduce is a jpg. I fetched mine from http://apod.nasa.gov/apod/ , one of their big pics should do it.\r\n    1. Add to the \"Docs\" folder in the solution\r\n    1. Change property of document to \"Copy always\"\r\n1. Copy paste the code below into your Program.cs file:\r\n\r\n```csharp\r\nusing System.IO;\r\nusing System.Linq;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Wordprocessing;\r\nusing Text = DocumentFormat.OpenXml.Wordprocessing.Text;\r\n\r\nnamespace TestWordAppend\r\n{\r\n    class Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            var destinationDoc = \"Docs/test-destination.docx\";\r\n            var sourceDoc = \"Docs/test-source.docx\";\r\n            var appendedDoc = \"Docs/test-append2.docx\";\r\n\r\n            File.Delete(destinationDoc);\r\n            File.Copy(sourceDoc, destinationDoc);\r\n\r\n            using (var doc = WordprocessingDocument.Open(destinationDoc, true))\r\n            {\r\n                var body = doc.MainDocumentPart.Document.Body;\r\n\r\n                var p2 = body.InsertAfter(\r\n                    new Paragraph(\r\n                        new ParagraphProperties(\r\n                            new PageBreakBefore()\r\n                    )),\r\n                    body.Elements<Paragraph>().Last()\r\n                );\r\n\r\n\r\n                var altChunkId = \"AltChunkId\";\r\n                var chunk = doc.MainDocumentPart.AddAlternativeFormatImportPart(\r\n                    AlternativeFormatImportPartType.WordprocessingML,\r\n                    altChunkId);\r\n\r\n                using (var fs = File.Open(appendedDoc, FileMode.Open))\r\n                    chunk.FeedData(fs);\r\n\r\n                var altChunk = new AltChunk { Id = altChunkId };\r\n                var run = new Run(new TabChar(), new Text(appendedDoc), new Break());\r\n                run.PrependChild(new RunProperties { RunStyle = new RunStyle { Val = \"Bold\" } });\r\n                var fileP = p2.InsertAfterSelf(new Paragraph());\r\n                fileP.Append(run);\r\n                run = new Run(new TabChar(), new Text(\"Uploaded by: \"), new TabChar(), new Text(\"Test User\"));\r\n                run.PrependChild(new RunProperties { RunStyle = new RunStyle { Val = \"Italic\" } });\r\n                fileP.Append(run);\r\n\r\n                body.Append(altChunk);\r\n                doc.MainDocumentPart.Document.Save();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n``` \r\n\r\n**Observed**\r\n\r\nWhen I open the destination document using Word on Mac, I will indeed see the document contents embedded in the destination document, however I can no longer utilize \"Save\" or \"Save As\".  Upon clicking \"save\" on a \"Save As\" when changing the name of the file, you will see the file name revert back to the original document name in the title and when you go to your \"Save As\" destination, you will not find a new document.  This problem does not exist in Word for Windows.\r\n\r\n**Expected**\r\n\r\nThe document should be able to be altered and saved within the MacOS Word application.\r\n"},{"Id":"11842942514","Type":"PullRequestEvent","CreatedAt":"2020-03-24T00:38:46","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/708","RelatedDescription":"Merged pull request \"Add no response support\" (#708) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11842926426","Type":"PullRequestEvent","CreatedAt":"2020-03-24T00:35:35","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/708","RelatedDescription":"Opened pull request \"Add no response support\" (#708) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11842923403","Type":"PullRequestEvent","CreatedAt":"2020-03-24T00:35:05","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/705","RelatedDescription":"Merged pull request \"Use Cache.ReadOnlyCollection<OpenXmlAttribute> for OpenXmlDomReader.Attributes\" (#705) at OfficeDev/Open-XML-SDK","RelatedBody":"The original code used the List type. This type will request a piece of memory by default.\r\n\r\nBecause we also need to support the .NET Framework versions below 4.6, and these versions do not exist Array.Empty method. See https://docs.microsoft.com/en-us/dotnet/api/system.array.empty\r\n\r\nThe `_emptyReadOnlyList` field  is only used here as the return value"},{"Id":"11842900586","Type":"IssuesEvent","CreatedAt":"2020-03-24T00:30:39","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/674","RelatedDescription":"Closed issue \"PPTX Sunburst chart?\" (#674) at OfficeDev/Open-XML-SDK","RelatedBody":"How would I go about creating a sunburst chart using OpenXML SDK? I tried reflecting it using the Productivity Tool but it would seem it does not support it correctly, and the chart itself is an image embedded into the PPTX. Seems to be stored very much differently than other types of charts.\r\n\r\nI know this is a question and not a bug, but SO is entirely unhelpful in answering new questions, I tried asking and they just outright closed my question."},{"Id":"11842893327","Type":"IssuesEvent","CreatedAt":"2020-03-24T00:29:12","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/98","RelatedDescription":"Closed issue \"Where are the w:headers and w:header elements?\" (#98) at OfficeDev/Open-XML-SDK","RelatedBody":"I understand that WordprocessingML got w:headers and w:header elements added on the standards, so that w:tcPr can have a w:headers child and the latest could have any amount of w:header elements as children.\n\nI could not find any reference or matching element whatsoever to use it. How could one get a reference to these elements by class name?\n\n> Annex M. (informative) Differences Between ECMA-376:2012 and ECMA-376:2006 \n> \n> This annex is informative.\n> \n> This annex highlights the differences between the versions of the Strict form of the Office Open XML schemas, as defined in ECMA-376:2012 and the schemas as defined by ECMA-376:2006.\n> \n> ...\n> - The header element (§17.4.18) was added\n> - The headers element (§17.4.19) was added\n\nAnd\n\n> 17.4.18 header (Header Cell Reference)\n> \n> This element specifies a reference, using a unique identifier, to a table header cell that is associated with the current table cell. The identifier representing the reference shall be stored on this element’s val attribute and is used to reference the unique identifier value of the id attribute of a header cell tc element of the current table.\n> The contents of the table header cell tc element designated by the specific unique identifier in its id attribute shall be used as the table header information associated with the table cell that references that specific unique identifier.\n> If this element is omitted or the value of the header cell identifier cannot be resolved, no header cell shall be associated with the current table cell.\n> \n> ...\n> \n> 17.4.19 headers (Header Cells Associated With Table Cell)\n> \n> This element specifies the list of header cells, as specified by children header elements, that provide header information associated with the current table cell. Each header cell shall specify a unique identifier, as specified by the use of the attribute id on the header cell tc element. This element is typically used to gather header information about data and sub header cells.\n> If this element is omitted or no children header element exists, no header cell shall be associated with the given table cell.\n> \n> ```\n> <w:tbl>\n>   …\n>   <w:tr>\n>     …\n>     <w:tc >\n>       …\n>     </w:tc>\n>     <w:tc w:id=\"HeaderA\">\n>        …\n>       <w:p>\n>         <w:r>\n>           <w:t>A</w:t>\n>         </w:r>\n>       </w:p>\n>     </w:tc>\n>     …\n>   </w:tr>\n>   <w:tr>\n>     …\n>     <w:tc w:id=\"HeaderC\">\n>       …\n>       <w:p>\n>         <w:r>\n>           <w:t>C</w:t>\n>         </w:r>\n>       </w:p>\n>     </w:tc>\n>     <w:tc>\n>       <w:tcPr>\n>         …\n>         <w:headers>\n>           <w:header w:val=\"HeaderA\" />\n>           <w:header w:val=\"HeaderC\" />\n>         </w:headers>\n>         …\n>       </w:tcPr>\n>       <w:p>\n>         <w:r>\n>           <w:t>x1</w:t>\n>         </w:r>\n>       </w:p>\n>     </w:tc>\n>     …\n>   </w:tr>\n> </w:tbl>\n> ```\n"},{"Id":"11842885899","Type":"IssuesEvent","CreatedAt":"2020-03-24T00:27:38","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/25","RelatedDescription":"Closed issue \"Validator reports constraint exceeded for gradientFill stop\" (#25) at OfficeDev/Open-XML-SDK","RelatedBody":"The validator reports an error for the following style definition:\n\n```\n  <x:fill>\n    <x:gradientFill type=\"linear\" degree=\"90\">\n      <x:stop position=\"0\">\n        <x:color theme=\"0\" />\n      </x:stop>\n      <x:stop position=\"1\">\n        <x:color theme=\"4\" />\n      </x:stop>\n      <x:stop position=\"2\">\n        <x:color rgb=\"00FF0000\" />\n      </x:stop>\n    </x:gradientFill>\n  </x:fill>\n```\n\nI can't find the matching constraint. This is specification for a gradientFill:\n\n```\n<xsd:complexType name=\"CT_GradientFill\">\n    <xsd:sequence>\n       <xsd:element name=\"stop\" type=\"CT_GradientStop\" minOccurs=\"0\" maxOccurs=\"unbounded\"/>\n    </xsd:sequence>\n    <xsd:attribute name=\"type\" type=\"ST_GradientType\" use=\"optional\" default=\"linear\"/>\n    <xsd:attribute name=\"degree\" type=\"xsd:double\" use=\"optional\" default=\"0\"/>\n    <xsd:attribute name=\"left\" type=\"xsd:double\" use=\"optional\" default=\"0\"/>\n    <xsd:attribute name=\"right\" type=\"xsd:double\" use=\"optional\" default=\"0\"/>\n    <xsd:attribute name=\"top\" type=\"xsd:double\" use=\"optional\" default=\"0\"/>\n    <xsd:attribute name=\"bottom\" type=\"xsd:double\" use=\"optional\" default=\"0\"/>\n</xsd:complexType>\n<xsd:complexType name=\"CT_GradientStop\">\n    <xsd:sequence>\n       <xsd:element name=\"color\" type=\"CT_Color\" minOccurs=\"1\" maxOccurs=\"1\"/>\n    </xsd:sequence>\n    <xsd:attribute name=\"position\" type=\"xsd:double\" use=\"required\"/>\n</xsd:complexType>\n```\n\nIf I understand this correctly then there can be an unlimited number of stops. Any limits could be imposed using the maxOccurs attribute of the fill.\n"},{"Id":"11842778491","Type":"IssuesEvent","CreatedAt":"2020-03-24T00:07:11","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/30","RelatedDescription":"Closed issue \"Markup Compatibility Extensibility (MCE) doesn't work properly in 2.5\" (#30) at OfficeDev/Open-XML-SDK","RelatedBody":"If you set FileFormatVersion.Office2010, then it correctly picks the 'Choice' element of an AlternateContent block for an inline text box.  If you set FileFormatVersion.Office2013, then it incorrectly picks the Fallback element of an AC block.\n\n```\nopenSettings = new OpenSettings();\nopenSettings.MarkupCompatibilityProcessSettings =\n    new MarkupCompatibilityProcessSettings(\n        MarkupCompatibilityProcessMode.ProcessAllParts,\n        FileFormatVersions.Office2010);\nusing (var wDoc = WordprocessingDocument.Open(outFile.FullName, true, openSettings))\n```\n\nWe should investigate other AlternateContent blocks, and see if this same behavior is there.  I suspect that it is.  I believe that the fix is where we change the code to take the Choice block if the setting version is equal to **or greater** than the implementation version for the Choice block.  Right now it appears that it takes the choice only if the version specified for MarkupCompatibilityProcessSettings is **equal** to the implementation version for the Choice block.\n\nWe should consider carefully how to fix this – we should have at least a point release (v2.6) to fix these types of bugs, because they could possibly cause different behavior in existing programs.\n"},{"Id":"11842774098","Type":"IssuesEvent","CreatedAt":"2020-03-24T00:06:22","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/31","RelatedDescription":"Closed issue \"Open XML SDK erroneously reports w:firstRow, w:lastRow, etc. attributes of table as invalid\" (#31) at OfficeDev/Open-XML-SDK","RelatedBody":"Further, the productivity tool doesn't generate code to generate these attributes.\n"},{"Id":"11842752292","Type":"IssuesEvent","CreatedAt":"2020-03-24T00:02:31","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/44","RelatedDescription":"Closed issue \"Validator ignores elements removed from the spec\" (#44) at OfficeDev/Open-XML-SDK","RelatedBody":"I've recently had Excel files that break the spec by including a \"mergeCell\" attribute in alignment elements. Such files should raise validation errors, certainly against the 2010 and 2013 formats but also against the 2007 as well. However this is currently not the case.\n\nFrom [MS-OE376]:\n2.1.720 Part 4 Section 3.8.1, alignment (Alignment)\na. The standard does not contain a @mergeCell attribute on the alignment element.\nExcel allows @mergeCell to be written on the alignment element. @mergeCell is not used by Office and is not necessary for interoperability.\nThis note applies to the following products: 2007, 2007 SP1, 2007 SP2. \n"},{"Id":"11842709532","Type":"PullRequestEvent","CreatedAt":"2020-03-23T23:54:20","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/707","RelatedDescription":"Opened pull request \"Ensure minimum office versions are included on enums\" (#707) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2020-03-24T05:30:46.3792909Z","RunDurationInMilliseconds":1097}