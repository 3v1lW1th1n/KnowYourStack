{"Data":{"Sdk":{"Events":[{"Id":"8373101299","Type":"IssuesEvent","CreatedAt":"2018-10-05T09:17:07","Actor":"rominator1983","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/525","RelatedDescription":"Opened issue \"ToFlatOpcDocument and ToFlatOpcString deliver a document that is not useable in MS Word when there is an altChunk-Part\" (#525) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\nToFlatOpcDocument and ToFlatOpcString deliver a document that is not useable in MS Word when there is an altChunk-Part.\r\n\r\nWhen a document contains an altChunk-Part with content-Type \"application/xhtml+xm\" the conversion routine returns a part with a pkg:xmlData-Element.\r\nSuch documents cannot be processed in MS Word (tested in 2010 and 2016).\r\n\r\nMS Word expects altChunk-Parts always to be in a binary format in a Flat-OPC-document. Otherwise there is an error (Word says the document is corrupted and asks if it should repair the document).\r\nThe part information is lost when trying to repair the document in MS Word.\r\n\r\nThis is controlled in OpenXmlPackage.GetContentsAsXml by checking: part.ContentType.EndsWith(\"xml\")\r\nThe standard lists the following content-types for altChunk:\r\n- text/plain\r\n- text/html\r\n- application/vnd.openxmlformats-officedocument.wordprocessingml.document\r\n- application/xhtml+xml\r\n\r\nThe 3rd entry seems like an error because +xml is missing in the standard. I did not try altChunk with Word-Processing-ML but I suppose Word expects a binary part too.\r\nConsidering that, a check for ending of \"xml\" or \"+xml\" is not really feasible for the problem.\r\n\r\nTo be able to tell, if this is an altChunk-Part that should be binary (for MS Word) the Relationship-Type (\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk\" or the purl-Version \"http://purl.oclc.org/ooxml/officeDocument/relationships/aFChunk\") of the part should be checked and not the content-Type of the part.\r\nThe check for \"xml\" could be done after this check for altChunk but should anyway rather be for \"+xml\" instead.\r\n\r\n**Information**\r\n\r\n- .NET Target: 4.6.1\r\n- DocumentFormat.OpenXml Version: 2.7.2 but code in 2.9 seams to have the same issue.\r\n\r\n**Repro**\r\nSee Unit-Test at:\r\nhttps://gist.github.com/rominator1983/248dcd826802eeb0a768f18fe709f2b1\r\n\r\nAn additional file (docx with altchunk) is needed:\r\nhttps://amforst.ddns.net/s/qd5RELXM6TeMX8t\r\n\r\n**Observed**\r\naltChunk-Part is returned as XML-Part instead of binary.\r\n\r\n**Expected**\r\naltChunk-Part is returned as binary-Part instead of XML-Part."},{"Id":"8366768385","Type":"IssuesEvent","CreatedAt":"2018-10-04T10:05:26","Actor":"smithapk","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/524","RelatedDescription":"Opened issue \"Detect pending track changes in excel using open xml \" (#524) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n\r\n- [ ] Question on library usage -Yes\r\n\r\n\r\n\r\n**Description**\r\n\r\nRequirement :\r\n\r\n                               Read pending track changes from excel which are not yet accepted or rejected\r\n\r\nProblem Statement:\r\n\r\n                             There is no tag to identify directly whether a track revision is accepted or rejected  in revision log .\r\n                           \r\n\r\nAssessment\r\n          \r\n                               Reached in  below assessment after analyzing  revision log  xml files  and revision headers xml files\r\n       \r\n•\tThere will be revision log corresponding to each revision (eg : revisionLog1.xml,…. revisionLog6.xml)  \r\n         \r\n                                                  This contains revision Id (rId) and cell details(eg: A1) of each revision \r\n        \r\n•\tThere is a  revisionheadrs.xml file \r\nThere exists a revision header corresponding to each  revision log \r\n\r\nBy correlating these two xml files with “rId” value we will get a unique record \r\n\r\nLast child of this record will have  reviewed tag if it is accepted or rejected\r\n\r\n\r\n\r\n                                    But there are some cases  this logic is failing\r\n\r\n\r\n                                             I analyzed the xml files of failing excel sheet\r\n                                              \r\n•\tIf there are more than one values (current value and previous values ) in accept or reject window for a cell .\r\n                                             if it is listing 4 records and I am accepting 2nd one \r\n                                             After accepting if again I  click this cell to accept or reject it will show a message -    There are no more pending changes to review\r\n                                             In this case maximum revision id comparison for each cell will fail \r\n\r\n                                                     <header guid=\"{9C3108F2-0497-4372-915B-71E20B8531C3}\" dateTime=\"2018-09-28T18:55:28\" maxSheetId=\"2\" userName=\"Smitha Puzhamkunnu\" r:id=\"rId5\" minRId=\"4\"><sheetIdMap count=\"1\"><sheetId val=\"1\"/></sheetIdMap>\r\n                                            <reviewedList count=\"1\"><reviewed rId=\"4\"/></reviewedList></header>                                             \r\n                                           \r\n                                             In this scenario rId=\"4\" is the last node . but the max rev id is  \"rId5\"  .\r\n                                            So it is showing incorrect result   -    There are pending changes to review\r\n                                         \r\n•\tIf we select accept all   or if we accept the last text  of a particular cell from accept or reject window the above  logic will work\r\n\r\n\r\nImplementation details\r\n\r\n                                        List<XmlElement> xmlElmnt = new List<XmlElement>();\r\n                    List<string> xmlInnerList = new List<string>();\r\n                    List<int> dicindexlist = new List<int>();\r\n                    dicindexlist.Add(-1);\r\n                    foreach (DocumentFormat.OpenXml.Packaging.WorkbookRevisionLogPart logpart in document.WorkbookPart.WorkbookRevisionHeaderPart.WorkbookRevisionLogParts)\r\n                    {\r\n                        var innerxml = logpart.Revisions.InnerXml;\r\n                        innerxml = \"<xmlroot>\" + innerxml + \"</xmlroot>\";\r\n                        xmlInnerList.Add(innerxml);\r\n\r\n                    }\r\n                    foreach (string innerelement in xmlInnerList)\r\n                    {\r\n                        XmlDocument xdoc = new XmlDocument();\r\n                        xdoc.LoadXml(innerelement);\r\n                        int ridvalue = 0;\r\n                        for (int k = 0; k < xdoc.ChildNodes.Count; k++)\r\n                        {\r\n                            var node1 = xdoc.ChildNodes[k];\r\n                            for (int cnt = 0; cnt < node1.ChildNodes.Count; cnt++)\r\n                            {\r\n                                var innernode = node1.ChildNodes[cnt];\r\n                                if (innernode.LocalName == \"rcc\")\r\n                                {\r\n                                    var attributes = innernode.Attributes;\r\n                                    var ridval = attributes.GetNamedItem(\"rId\");\r\n                                    //ridvalue = ridval.LocalName + ridval.InnerText;\r\n                                    ridvalue = Convert.ToInt32(ridval.InnerText);\r\n                                }\r\n                                for (int x = 0; x < innernode.ChildNodes.Count; x++)\r\n                                {\r\n                                    var node2 = innernode.ChildNodes[x];\r\n                                    var node2Attributes = node2.Attributes;\r\n                                    var callidval = node2Attributes.GetNamedItem(\"r\");\r\n                                    if (!DicXmlValues.ContainsKey(ridvalue))\r\n                                    {\r\n                                        DicXmlValues.Add(ridvalue, callidval.InnerText);\r\n                                    }\r\n                                    break;\r\n                                }\r\n\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                    Dictionary<int, string> dicval = new Dictionary<int, string>();\r\n                    foreach (KeyValuePair<int, string> xmlval in DicXmlValues.OrderBy(key => key.Value))\r\n                    {\r\n\r\n                        dicval.Add(xmlval.Key, xmlval.Value);\r\n                    }\r\n\r\n                    List<int> indexlist = new List<int>();\r\n\r\n                    for (int d = 0; d < dicval.Count - 1; d++)\r\n                    {\r\n                        if (dicval.ElementAt(d).Value != dicval.ElementAt(d + 1).Value)\r\n                        {\r\n                            dicindexlist.Add(d);\r\n\r\n                            indexlist.Add(dicval.ElementAt(d).Key);\r\n                        }\r\n                    }\r\n                    dicindexlist.Add(dicval.Count - 1);\r\n                    for (int index1 = 0; index1 < dicindexlist.Count - 1; index1++)\r\n                    {\r\n\r\n                        int endindex = dicval.Count - ((dicval.Count - dicindexlist[index1 + 1]));\r\n                        int startindex = endindex - (dicindexlist[index1 + 1] - (dicindexlist[index1] + 1));\r\n                        Dictionary<int, string> resultdicval = new Dictionary<int, string>();\r\n                        Dictionary<int, string> orderedresultdicval = new Dictionary<int, string>();\r\n                        for (int index2 = startindex; index2 <= endindex; index2++)\r\n                        {\r\n\r\n                            resultdicval.Add(dicval.ElementAt(index2).Key, dicval.ElementAt(index2).Value);\r\n\r\n                        }\r\n                        foreach (KeyValuePair<int, string> indxval in resultdicval.OrderBy(x => x.Key))\r\n                        {\r\n\r\n                            orderedresultdicval.Add(indxval.Key, indxval.Value);\r\n                        }\r\n                        int indxmaxvalue = orderedresultdicval.Keys.Max();\r\n                        string rlVal = \"rId\" + indxmaxvalue;\r\n\r\n                        foreach (DocumentFormat.OpenXml.Spreadsheet.Header hdr in document.WorkbookPart.WorkbookRevisionHeaderPart.Headers)\r\n                        {\r\n                            if (rlVal == hdr.Id)\r\n                            {\r\n                                headerrecored = hdr;\r\n                                var rec = headerrecored.LastChild;\r\n                                if (rec.LocalName != \"reviewedList\")\r\n                                {\r\n                                    pendingchanges = pendingchanges + 1;\r\n                                }\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    string msg = \"\";\r\n                    if (pendingchanges > 0)\r\n                    {\r\n                         msg = \"There are pending changes to review\";\r\n                    }\r\n                    else\r\n                    {\r\n                         msg = \"There are no more pending changes to review\";\r\n                    }\r\n                                         https://social.msdn.microsoft.com/Forums/office/en-US/253c2315-f954-4e39-b30b-e10fbddf685c/how-to-get-track-changes-which-are-not-accepted-or-rejected-in-excel?forum=oxmls\r\n\r\n                                         https://social.msdn.microsoft.com/Forums/office/en-US/2848801d-a8b2-4dc4-a4ce-39a7c74cabee/open-xml-excel-to-detect-track-changes?forum=oxmlsdk\r\n                                           \r\n                                         https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2010/cc797468(v=office.14)\r\n\r\n\r\nOpen Questions\r\n                              \r\n                    \r\n1.\tHow can we identify whether a revision is accepted or rejected directly from revision log in excel .\r\n2.\tHow can we get only the pending track changes which are not accepted or rejected \r\n\r\n\r\n**Information**\r\n\r\n.NET FRAMEWORK  4.5\r\nDocumentFormat.OpenXml Version  - 2.8.1.15\r\n\r\n\r\n``` \r\n\r\n**Observed**\r\nThere is no way to identify whether a particular track change is accepted ,rejected or pending for  review directly from program\r\n\r\n**Expected**\r\n\r\nNeed to get pending track changes which is not yet accepted or rejected "},{"Id":"8299244058","Type":"IssuesEvent","CreatedAt":"2018-09-21T01:43:27","Actor":"guyuming76","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/523","RelatedDescription":"Opened issue \"rsid related issue for insert picture to Word with openxml sdk\" (#523) at OfficeDev/Open-XML-SDK","RelatedBody":"https://social.msdn.microsoft.com/Forums/en-US/92a94048-3339-4943-90e0-03fe8d0632a9/cannot-open-docx-after-inserting-picture-with-openxml-problem-with-partworddocumentxml?forum=os_binaryfile#65fb63fb-7ce4-4521-acf2-3b9a7551c302\r\n\r\n"},{"Id":"8288795449","Type":"PullRequestEvent","CreatedAt":"2018-09-19T13:05:58","Actor":"daniel-white","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/476","RelatedDescription":"Closed pull request \"adding strongly typed methods to OpenXmlReader fixes #398\" (#476) at OfficeDev/Open-XML-SDK","RelatedBody":"This implements the request I made in #398.\r\n\r\n* I dropped the word `Current` as it is additional fluff of a word - the property is `ElementType` so i deemed it unnecessary \r\n* I went with the `Try` in the name of the \"safe\" method, although i wish there was a better pattern.\r\n* Made the methods virtual since this is an abstract class for backwards compatibility.\r\n* Added one resource string.\r\n* Added test coverage."}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[{"Id":"8397612894","Type":"PullRequestEvent","CreatedAt":"2018-10-10T13:12:45","Actor":"prog-mahmoud","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/256","RelatedDescription":"Opened pull request \"Fix issue related to text-align with rtl direction\" (#256) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"When adding style=\"direction:rtl; text-align:left\" it doesn't apply text-align property."},{"Id":"8386625806","Type":"PullRequestEvent","CreatedAt":"2018-10-08T20:42:11","Actor":"ThomasBarnekow","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/255","RelatedDescription":"Opened pull request \"Refactor WmlComparer\" (#255) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"This commit refactors the `WmlComparer`, putting classes into their own files and splitting the very large `WmlComparer` class into multiple partial classes. If further fixes many (but not all) issues flagged by\r\nstatic code analysis.\r\n\r\nFor easier reference, the existing `WmlComparer` class is temporarily retained in the `OpenXmlPowerTools.Previous` namespace. For organizational purposes, the refactored version is stored in the`Comparer` folder, which does however not create a namespace.\r\n\r\nThe objective of this commit is to not create breaking changes. The one exception is the removal of the internal `WmlComparer.Coalesce` method, which was only invoked in one unit test. This is deemed a left-over from previous rewrites and is thus removed. The unit test is commented\r\nout for now.\r\n\r\nThis pull request essentially prepares the `WmlComparer` for future enhancements."},{"Id":"8354079435","Type":"IssuesEvent","CreatedAt":"2018-10-02T12:16:45","Actor":"DiplIngAndreasScholz","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/254","RelatedDescription":"Opened issue \"Converting ordered/unordered lists\" (#254) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"When converting an ordered list to word using ConvertHtmlToWml output is always an unordered list.\r\nInput: \r\n<html xml:space=\"preserve\" xmlns=\"http://www.w3.org/1999/xhtml\">   <ol>     <li>   ordered list</li>     <li>zwei</li>   </ol>   <ul>     <li>unordered list</li>     <li>bullet</li>   </ul> </html>\r\n\r\nOutput:\r\n•\tordered list\r\n•\tzwei\r\n•\tunordered list\r\n•\tbullet\r\n"},{"Id":"8303257049","Type":"IssuesEvent","CreatedAt":"2018-09-21T16:55:57","Actor":"jureles","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/253","RelatedDescription":"Opened issue \"HtmlToWmlCssParser.cs Parsing Error\" (#253) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Hi,\r\n\r\nThere is a CSS parsing error that occurs in HtmlToWmlCssParser.cs.\r\n\r\nThe CSS parser throws an exception for the following CSS style:\r\n`border: solid red .5pt`\r\n\r\nOn the other side the following CSS style string is properly parsed:\r\n`border: solid red 0.5pt`\r\n\r\nI would try to  fix this myself, but I haven't seen any grammar file in the project where I could fix this. It seems like the CSS parsing classes are auto generated. Can someone tell me where can I get it and which  parser generator technology is used?"},{"Id":"8288316304","Type":"IssuesEvent","CreatedAt":"2018-09-19T11:36:47","Actor":"DaveyRance","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/252","RelatedDescription":"Opened issue \"Unable to run / find / build Powershell Module\" (#252) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Good morning i have been struggling with trying to get the powershell module working for the last day or so.\r\n\r\nIf i follow the instructions from https://www.youtube.com/watch?v=60w-yPDSQD0 i am able to clone the open-xml-sdk and open-xml-powertools no issues to my powershell\\modules folder. Compile the sdk no issues but on checking the powertools folder there is no powershell module. Checking the branch i noticed that the branch is vNext and it seems that the powershell modules are not in that branch. \r\n\r\nSo then change the open-xml-powertools to master and now i have the module. (Execution policy is set to remote signed)\r\n\r\nImport-module open-xml-powertools gives a whole screen of red where the basics are that the paths are incorrect. Example below\r\n\r\nAdd-Type : Cannot bind parameter 'Path' to the target. Exception setting \"Path\": \"Cannot find path\r\n'C:\\Users\\Davey\\Documents\\Open-Xml-Sdk\\DocumentFormat.OpenXml\\bin\\debug\\DocumentFormat.OpenXml.dll' because it does\r\nnot exist.\"\r\nAt C:\\Users\\Davey\\Documents\\WindowsPowerShell\\Modules\\open-xml-powertools\\AddTypes.ps1:68 char:16\r\n+ ... -Type -Path \"$PSScriptRoot\\..\\..\\..\\Open-Xml-Sdk\\DocumentFormat.OpenX ...\r\n+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : WriteError: (:) [Add-Type], ParameterBindingException\r\n    + FullyQualifiedErrorId : ParameterBindingFailed,Microsoft.PowerShell.Commands.AddTypeCommand\r\n\r\nNext i tried to compile the master branch of open-xml-powertools thinking that if i ignored the documentation that said just import the module and instead try to build it i got a whole bunch of errors like this.\r\nSeverity\tCode\tDescription\tProject\tFile\tLine\tSuppression State\r\nError\tCS0246\tThe type or namespace name 'DocumentFormat' could not be found (are you missing a using directive or an assembly reference?)\tOpenXmlPowerTools\tC:\\Users\\Davey\\Documents\\WindowsPowerShell\\Modules\\Open-Xml-PowerTools\\OpenXmlPowerTools\\ChartUpdater.cs\t7\tActive\r\n\r\nSo is it that the master branch needs to have something updated or am i missing a step for the vNext.\r\n\r\nThanks"},{"Id":"8271566984","Type":"IssuesEvent","CreatedAt":"2018-09-16T10:40:29","Actor":"IrakliLomidze","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/251","RelatedDescription":"Opened issue \"ConvertToHtml have an issue with Strict Open XML Files\" (#251) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"ConvertToHtml have issue with Strict Open XML Files\r\n\r\n...\r\n   XElement htmlElement = WmlToHtmlConverter.ConvertToHtml(wDoc, settings);\r\nGenerate Null reference exception, But if document is in TRANSITIONAL DOCX format all works fine.\r\n\r\n\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2018-10-12T05:30:44.9421366Z","RunDurationInMilliseconds":1836}