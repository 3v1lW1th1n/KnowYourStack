{"Data":{"Sdk":{"Events":[{"Id":"7808093796","Type":"IssuesEvent","CreatedAt":"2018-06-11T19:01:11","Actor":"NerdBrick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/509","RelatedDescription":"Opened issue \"A simple newely created OpenXML file will not open in Spreadsheet comparison tool\" (#509) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [ Yes] Issue with the OpenXml library\r\n- [ No] Question on library usage\r\n\r\nIf you have answered that this is a question, please ask it on StackOverflow instead of here.\r\nThis issue tracker is meant to track product issues while StackOverflow excels at answering questions\r\n\r\n---------------- Remove this line and above before posting ----------------\r\n\r\n**Description**\r\nStarted on MSDN support first. \r\nhttps://social.msdn.microsoft.com/Forums/office/en-US/fa395b57-ab12-4fe8-9fa1-0726c18fe0cd/openxml-generated-file-wont-open-in-ms-spreadsheet-compare-tool-and-excel-quotopen-and?forum=oxmlsdk\r\n\r\nThe basic problem is when a new file is created by OpenXML, it appears to load in Excel, but if you use the Excel File Open tool for \"Open and Repair\" you can see there are some hidden errors being reported. My assumption is the tool Spreadhsheet Compare tool from MS Office can't open this file because of teh same underlying error. If the file is opened and then saved in Excel, the tool now open the file. \r\n\r\n\r\n**Information**\r\n\r\n- .NET Target: 4.7.1\r\n- DocumentFormat.OpenXml Version: 2.8.1.0\r\n\r\n**Repro**\r\n\r\n```csharp\r\npublic static void CreateSpreadsheetWorkbook(string filepath)\r\n        {\r\n            // Create a spreadsheet document by supplying the filepath.\r\n            // By default, AutoSave = true, Editable = true, and Type = xlsx.\r\n            SpreadsheetDocument spreadsheetDocument = SpreadsheetDocument.Open(filepath, true);\r\n\r\n            // Add a WorksheetPart to the WorkbookPart.\r\n            WorksheetPart worksheetPart = spreadsheetDocument.WorkbookPart.AddNewPart<WorksheetPart>();\r\n            worksheetPart.Worksheet = new Worksheet(new SheetData());\r\n\r\n            // Add Sheets to the Workbook.\r\n            Sheets sheets = spreadsheetDocument.WorkbookPart.Workbook.\r\n                AppendChild<Sheets>(new Sheets());\r\n\r\n            // Append a new worksheet and associate it with the workbook.\r\n            Sheet sheet = new Sheet()\r\n            {\r\n                Id = spreadsheetDocument.WorkbookPart.\r\n                    GetIdOfPart(worksheetPart),\r\n                SheetId = 1,\r\n                Name = \"mySheet\"\r\n            };\r\n            sheets.Append(sheet);\r\n\r\n            spreadsheetDocument.WorkbookPart.Workbook.Save();\r\n\r\n            // Close the document.\r\n            spreadsheetDocument.Close();\r\n        }``` \r\n\r\n**Observed**\r\n\r\nSpreadsheet Comparison tool will report\r\nhttps://support.office.com/en-us/article/Basic-tasks-in-Spreadsheet-Compare-F2B20AF8-A6D3-4780-8011-F15B3229F5D8\r\n\r\n\"Error opening workbook. Attempted to read past the end of the stream\"\r\n\r\nIf you attempt to open the file through Excel \"Open and Repair\" option, you will get this XML error. \r\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\r\n<recoveryLog xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">\r\n<logFileName>error260080_01.xml</logFileName><summary>Errors were detected in file 'C:\\TEMP\\testing.xlsx'</summary>\r\n<additionalInfo><info>Excel completed file level validation and repair. Some parts of this workbook may have been repaired or discarded.</info></additionalInfo>\r\n</recoveryLog>\r\n\r\n**Expected**\r\nFile should open without errors.\r\n\r\nPlease add your expected behavior here.\r\n\r\n"}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[{"Id":"7806667523","Type":"IssuesEvent","CreatedAt":"2018-06-11T14:40:47","Actor":"VladDragnea","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/227","RelatedDescription":"Opened issue \"Accepting Revisions on a document that contains AlternativeFormatImportPart will remove the part\" (#227) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Hi. I have this issue with any kind of document that contains altChunk element. Calling: OpenXmlPowerTools.RevisionAccepter.AcceptRevisions(wordDocument) on that document will remove all altChunk elements within the body of the document. I assume this is not supposed to happen, or am I wrong?\r\nThis is a simple version of a file on which this issue is happening:\r\n[Test.docx](https://github.com/OfficeDev/Open-Xml-PowerTools/files/2090414/Test.docx)\r\nand a scheenshot with the dom before:\r\n![test](https://user-images.githubusercontent.com/15382360/41238189-9d92a646-6d95-11e8-8f3b-7f93cc501897.png)\r\nAnd this is the document after calling AcceptRevisions:\r\n[Test-accepted.docx](https://github.com/OfficeDev/Open-Xml-PowerTools/files/2090427/Test-accepted.docx)\r\nwith a screenshot of the dom:\r\n![test-accepted](https://user-images.githubusercontent.com/15382360/41238247-c9bd16d4-6d95-11e8-97e3-c9c3c6e77eca.png)\r\n"},{"Id":"7788135122","Type":"IssuesEvent","CreatedAt":"2018-06-07T02:41:59","Actor":"v-fanfan","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/226","RelatedDescription":"Opened issue \"This is no Open-Xml-PowerTools.psm1 file, that I can import module to PS\" (#226) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""},{"Id":"7767513467","Type":"IssuesEvent","CreatedAt":"2018-06-03T07:16:04","Actor":"YoungroKim","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/225","RelatedDescription":"Closed issue \"The bookmark ID may also be a string.\" (#225) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"The bookmark ID can also be a string. However, the code below assumes that the bookmark ID always contains only digits.\r\n\r\nDocumentBuilder.cs\r\n\r\n`\r\nprivate static void AdjustUniqueIds(WordprocessingDocument sourceDocument,\r\n            WordprocessingDocument newDocument, IEnumerable<XElement> newContent)\r\n        {\r\n            ......\r\n                int id = (int)item.Attribute(W.id);\r\n                if (!bookmarkIdMap.ContainsKey(id))\r\n                    bookmarkIdMap.Add(id, ++maxId);\r\n......\r\n        }\r\n`"},{"Id":"7767499472","Type":"IssuesEvent","CreatedAt":"2018-06-03T07:04:02","Actor":"YoungroKim","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/225","RelatedDescription":"Opened issue \"The bookmark ID may also be a string.\" (#225) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"The bookmark ID can also be a string. However, the code below assumes that the bookmark ID always contains only digits.\r\n\r\nDocumentBuilder.cs\r\n`private static void AdjustUniqueIds(WordprocessingDocument sourceDocument,\r\n            WordprocessingDocument newDocument, IEnumerable<XElement> newContent)\r\n        {\r\n            // adjust bookmark unique ids\r\n            int maxId = 0;\r\n            if (newDocument.MainDocumentPart.GetXDocument().Descendants(W.bookmarkStart).Any())\r\n                maxId = newDocument.MainDocumentPart.GetXDocument().Descendants(W.bookmarkStart)\r\n                    .Select(d => (int)d.Attribute(W.id)).Max();\r\n            Dictionary<int, int> bookmarkIdMap = new Dictionary<int, int>();\r\n            foreach (var item in newContent.DescendantsAndSelf().Where(bm => bm.Name == W.bookmarkStart ||\r\n                bm.Name == W.bookmarkEnd))\r\n            {\r\n                **int id = (int)item.Attribute(W.id);**\r\n                if (!bookmarkIdMap.ContainsKey(id))\r\n                    bookmarkIdMap.Add(id, ++maxId);\r\n            }\r\n            foreach (var bookmarkElement in newContent.DescendantsAndSelf().Where(e => e.Name == W.bookmarkStart ||\r\n                e.Name == W.bookmarkEnd))\r\n                bookmarkElement.Attribute(W.id).Value = bookmarkIdMap[(int)bookmarkElement.Attribute(W.id)].ToString();\r\n\r\n            // adjust shape unique ids\r\n            // This doesn't work because OLEObjects refer to shapes by ID.\r\n            // Punting on this, because sooner or later, this will be a non-issue.\r\n            //foreach (var item in newContent.DescendantsAndSelf(VML.shape))\r\n            //{\r\n            //    Guid g = Guid.NewGuid();\r\n            //    string s = \"R\" + g.ToString().Replace(\"-\", \"\");\r\n            //    item.Attribute(NoNamespace.id).Value = s;\r\n            //}\r\n        }`"},{"Id":"7709896413","Type":"IssuesEvent","CreatedAt":"2018-05-22T10:35:33","Actor":"VictorIranzo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/224","RelatedDescription":"Opened issue \"ChartUpdater: Support for Combo charts\" (#224) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Hi,\r\nWe are interested in ChartUpdater working with Combo charts. The combo charts are those that mix series of different chart types. A combo chart can be done using Word as shown at the screenshot:\r\n \r\n![image](https://user-images.githubusercontent.com/27296704/40357379-4cb39ce6-5dbc-11e8-9440-dc050b7c3ce6.png)\r\n\r\nWe have tested the current ChartUpdater component for replacing the values of this chart in a DOCX:\r\n \r\n![image](https://user-images.githubusercontent.com/27296704/40357386-53e63dfc-5dbc-11e8-9e1e-475d3d3267a1.png)\r\n\r\nThis chart combines two series: one is a bar chart and the other a line chart, with only the dots and in the secondary axis.\r\n\r\nWe provide in this repository an application that tests this: \r\nhttps://github.com/VictorIranzo/UpdateComboChart \r\n\r\nThe result obtained is not the expected one. It seems that the ChartUpdater has added the new values of the two series in the bar chart section and has kept the section of the line chart. We couldn’t open the output document using Word, but if we use another editor like LibreOffice we see the mentioned result:\r\n \r\n![image](https://user-images.githubusercontent.com/27296704/40357400-5ca8e692-5dbc-11e8-9a7b-4bdb94b3e685.png)\r\n\r\nAs you see, there are 3 series. The ‘Percentage’ series contains the data of the old chart. If we remove the line series manually opening the ‘chart1.xml’ file of the document, we realize that the values provided for the new chart have been inserted in the bar chart section:\r\n\r\n![image](https://user-images.githubusercontent.com/27296704/40357421-6c11038a-5dbc-11e8-924d-ce533c87e458.png)\r\n \r\nAs we said, we are interested in this feature. We would like to know if you have planned to implement this feature.\r\nThanks \r\n\r\n\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2018-06-17T05:30:49.0855139Z","RunDurationInMilliseconds":2231}