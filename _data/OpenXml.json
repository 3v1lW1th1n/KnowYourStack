{"Data":{"Sdk":{"Events":[{"Id":"7191264019","Type":"PullRequestEvent","CreatedAt":"2018-02-02T20:19:18","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/399","RelatedDescription":"Opened pull request \"Remove fixed known issue\" (#399) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7190625619","Type":"PullRequestEvent","CreatedAt":"2018-02-02T17:55:49","Actor":"tomjebo","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/395","RelatedDescription":"Merged pull request \"Create a base document test that ensures tests for each package type are run\" (#395) at OfficeDev/Open-XML-SDK","RelatedBody":"This creates a `DocumentTests<T> where T : OpenXmlPackage` that are subclassed by `WordprocessingDocumentTests`, `SpreadsheetDocumentTests`, `PresentationDocumentTests`. Previously, all tests for these were duplicated for each of the document types.\r\n\r\nPart of #166"},{"Id":"7186987420","Type":"IssuesEvent","CreatedAt":"2018-02-02T02:15:16","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/393","RelatedDescription":"Reopened issue \"Strict http://purl.oclc.org/ooxml/spreadsheetml/main tables fail validation\" (#393) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nStrict namespace spreadsheetml tables throw an exception in OpenXmlValidator.\r\n\r\n**Information**\r\n\r\n- .NET Target: whatever the default is in VS\r\n- DocumentFormat.OpenXml Version: 2.5.0, 2.8.1\r\n\r\n**Repro**\r\n\r\nTrivial spreadsheet that triggers the problem: [test.xlsx](https://github.com/OfficeDev/Open-XML-SDK/files/1668722/test.xlsx)\r\n\r\n*_rels/worksheet.xml.rels* has `<Relationship Id='rId1' Type='http://purl.oclc.org/ooxml/officeDocu\r\nment/relationships/table' Target='table.xml' />` which should, I think, enable `StrictTranslation`.\r\n\r\n*table.xml* has `<table xmlns='http://purl.oclc.org/ooxml/spreadsheetml/main' id='1' displayName='Data' ref='A1:B3'>`\r\n\r\nBoth URLs are straight from ECMA-376, Part 1, *12.3.21 Table Definition Part*.\r\n\r\nAdditionally, both LibreOffice and Office Online are able to load the table definition, which arguably might not signify anything.\r\n\r\n```csharp\r\nSpreadsheetDocument document = SpreadsheetDocument.Open(\"test.xlsx\", false);\r\nOpenXmlValidator validator = new OpenXmlValidator(FileFormatVersions.Office2010);\r\nvalidator.Validate(document);\r\n``` \r\n\r\n**Observed**\r\n\r\n```\r\nSystem.IO.InvalidDataException\r\n  HResult=0x80131501\r\n  Message=Cannot load the root element from the part. The part contains invalid data.\r\n  Source=DocumentFormat.OpenXml\r\n  StackTrace:\r\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPart.LoadDomTree[T]()\r\n   at DocumentFormat.OpenXml.Packaging.TableDefinitionPart.get_PartRootElement()\r\n   at DocumentFormat.OpenXml.Validation.DocumentValidator.ValidatePart(OpenXmlPart part)\r\n   at DocumentFormat.OpenXml.Validation.DocumentValidator.Validate(OpenXmlPackage document)\r\n   at DocumentFormat.OpenXml.Validation.OpenXmlValidator.Validate(OpenXmlPackage openXmlPackage)\r\n   at ConsoleApp1.Program.Main(String[] args) in C:\\Users\\IEUser\\source\\repos\\ConsoleApp1\\ConsoleApp1\\Program.cs:line 18\r\n\r\nInner Exception 1:\r\nInvalidDataException: The root XML element \"http://purl.oclc.org/ooxml/spreadsheetml/main:table\" in the part is incorrect. The expected root XML element is: \"http://schemas.openxmlformats.org/spreadsheetml/2006/main:table\".\r\n```\r\n\r\n**Expected**\r\n\r\nNo exception should be thrown and no errors returned."},{"Id":"7185003179","Type":"IssuesEvent","CreatedAt":"2018-02-01T18:03:12","Actor":"daniel-white","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/398","RelatedDescription":"Opened issue \"Proposed OpenXmlReader methods\" (#398) at OfficeDev/Open-XML-SDK","RelatedBody":"\r\nIn order to make more succinct calling code, I've extended `OpenXmlReader` in my code with these helpers. I propose that something similar can be added to the library.\r\n\r\n```\r\npublic T LoadCurrentElement<T>() where T : OpenXmlElement => (T)_reader.LoadCurrentElement();\r\n\r\npublic bool ElementTypeIs<T>() where T : OpenXmlElement => ElementType == typeof(T);\r\n\r\npublic bool ElementIs<T>(out T element) where T : OpenXmlElement\r\n{\r\n       element = null;\r\n\r\n        if (ElementTypeIs<T>())\r\n        {\r\n            element = LoadCurrentElement<T>();\r\n            return true;\r\n       }\r\n\r\n       return false;\r\n}\r\n```\r\n\r\n`ElementIs<T>` plays nice with the new `out` semantics introduced in C# 7.0. Instead of this mess, \r\n\r\n```\r\nif (reader.ElementType == typeof(Paragraph))\r\n{\r\n    Paragraph p = (Paragraph)reader.LoadCurrentElement();\r\n    // ...\r\n}\r\n```\r\n\r\nthe new methods provide a simplification\r\n\r\n```\r\nif (reader.ElementIs(out Paragraph p)\r\n{\r\n    // ...\r\n}\r\n```\r\n\r\nThoughts?"},{"Id":"7184923852","Type":"PullRequestEvent","CreatedAt":"2018-02-01T17:46:55","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/390","RelatedDescription":"Merged pull request \"Create single ValidationContext and remove mutability from validators\" (#390) at OfficeDev/Open-XML-SDK","RelatedBody":"This simplifies some of the validation logic and removes more mutability. There's probably some more that can be addressed later, but this creates a single `ValidationContext` to track errors and whether or not validation is cancelled. By doing this, a number of eventing patterns can be removed, which should help a bit with performance on large validation scenarios."},{"Id":"7181545083","Type":"IssuesEvent","CreatedAt":"2018-02-01T05:44:26","Actor":"pjanouch","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/393","RelatedDescription":"Closed issue \"Strict http://purl.oclc.org/ooxml/spreadsheetml/main tables fail validation\" (#393) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nStrict namespace spreadsheetml tables throw an exception in OpenXmlValidator.\r\n\r\n**Information**\r\n\r\n- .NET Target: whatever the default is in VS\r\n- DocumentFormat.OpenXml Version: 2.5.0, 2.8.1\r\n\r\n**Repro**\r\n\r\nTrivial spreadsheet that triggers the problem: [test.xlsx](https://github.com/OfficeDev/Open-XML-SDK/files/1668722/test.xlsx)\r\n\r\n*_rels/worksheet.xml.rels* has `<Relationship Id='rId1' Type='http://purl.oclc.org/ooxml/officeDocu\r\nment/relationships/table' Target='table.xml' />` which should, I think, enable `StrictTranslation`.\r\n\r\n*table.xml* has `<table xmlns='http://purl.oclc.org/ooxml/spreadsheetml/main' id='1' displayName='Data' ref='A1:B3'>`\r\n\r\nBoth URLs are straight from ECMA-376, Part 1, *12.3.21 Table Definition Part*.\r\n\r\nAdditionally, both LibreOffice and Office Online are able to load the table definition, which arguably might not signify anything.\r\n\r\n```csharp\r\nSpreadsheetDocument document = SpreadsheetDocument.Open(\"test.xlsx\", false);\r\nOpenXmlValidator validator = new OpenXmlValidator(FileFormatVersions.Office2010);\r\nvalidator.Validate(document);\r\n``` \r\n\r\n**Observed**\r\n\r\n```\r\nSystem.IO.InvalidDataException\r\n  HResult=0x80131501\r\n  Message=Cannot load the root element from the part. The part contains invalid data.\r\n  Source=DocumentFormat.OpenXml\r\n  StackTrace:\r\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPart.LoadDomTree[T]()\r\n   at DocumentFormat.OpenXml.Packaging.TableDefinitionPart.get_PartRootElement()\r\n   at DocumentFormat.OpenXml.Validation.DocumentValidator.ValidatePart(OpenXmlPart part)\r\n   at DocumentFormat.OpenXml.Validation.DocumentValidator.Validate(OpenXmlPackage document)\r\n   at DocumentFormat.OpenXml.Validation.OpenXmlValidator.Validate(OpenXmlPackage openXmlPackage)\r\n   at ConsoleApp1.Program.Main(String[] args) in C:\\Users\\IEUser\\source\\repos\\ConsoleApp1\\ConsoleApp1\\Program.cs:line 18\r\n\r\nInner Exception 1:\r\nInvalidDataException: The root XML element \"http://purl.oclc.org/ooxml/spreadsheetml/main:table\" in the part is incorrect. The expected root XML element is: \"http://schemas.openxmlformats.org/spreadsheetml/2006/main:table\".\r\n```\r\n\r\n**Expected**\r\n\r\nNo exception should be thrown and no errors returned."},{"Id":"7179984861","Type":"PullRequestEvent","CreatedAt":"2018-01-31T21:34:36","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/396","RelatedDescription":"Merged pull request \"Add overload PackageAssert.NotEqual\" (#396) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"7173755245","Type":"PullRequestEvent","CreatedAt":"2018-01-30T21:02:18","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/391","RelatedDescription":"Merged pull request \"Update FxCop and VSTest to stable versions\" (#391) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[{"Id":"7177141433","Type":"IssuesEvent","CreatedAt":"2018-01-31T12:36:13","Actor":"mesteves","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/201","RelatedDescription":"Opened issue \"Images Support\" (#201) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"\r\nHi any plans to include something image support like this fork \r\n\r\nhttps://github.com/krembf/Open-Xml-PowerTools/commit/3779fc4f8ed11432b81f133a095f0fc3fe84c86e\r\n\r\nThanks in advance!"},{"Id":"7114740250","Type":"PullRequestEvent","CreatedAt":"2018-01-18T02:27:51","Actor":"lpperras","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/200","RelatedDescription":"Opened pull request \"Safe HTML to wml\" (#200) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Check for properties that could be null when HTML is parsed."},{"Id":"7103446568","Type":"PullRequestEvent","CreatedAt":"2018-01-16T05:07:12","Actor":"lpperras","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/199","RelatedDescription":"Opened pull request \"No settings fix\" (#199) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Fixed issue with converting a docx to HTML that has no settings file."},{"Id":"7103393888","Type":"PullRequestEvent","CreatedAt":"2018-01-16T04:43:30","Actor":"lpperras","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/70","RelatedDescription":"Closed pull request \"Ability to process Flat to OPC and OPC to Flat in memory.\" (#70) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Added a couple of overloads to make it possible to transfer a flat opc structure to a docx package and vice versa without writing to disk.\n"},{"Id":"7102446154","Type":"IssuesEvent","CreatedAt":"2018-01-15T22:17:57","Actor":"AlirezaAhmadiRad","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/issues/198","RelatedDescription":"Opened issue \"Exception during conversion of html table to docx\" (#198) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Hello\r\nI have [this html file](https://1drv.ms/f/s!Alj_FDyopEuRgtp3ZozLwqQGXxZNWQ). \r\nThis is code for converting it to docx:\r\n\r\n`                                XElement X = XElement.Parse(HT.HTML); \r\n                                HtmlToWmlConverterSettings S = HtmlToWmlConverter.GetDefaultSettings(); \r\n                                WmlDocument D = HtmlToWmlConverter.ConvertHtmlToWml(\"\", \"\", \"\", X, S); \r\n                                sources.Add(new Source(D, true));\r\n`\r\n\r\nThen I receive exception of \"Object reference not set to an instance of an object.\" at this address:\r\n\r\n   at OpenXmlPowerTools.HtmlToWml.HtmlToWmlConverterCore.GetTableGrid(XElement element, HtmlToWmlConverterSettings settings)     \r\n   at OpenXmlPowerTools.HtmlToWml.HtmlToWmlConverterCore.Transform(XNode node, HtmlToWmlConverterSettings settings, WordprocessingDocument wDoc, NextExpected nextExpected, Boolean preserveWhiteSpace)     \r\n   at OpenXmlPowerTools.HtmlToWml.HtmlToWmlConverterCore.<>c__DisplayClass20_0.<Transform>b__6(XNode n)     \r\n   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()     \r\n   at System.Xml.Linq.XContainer.AddContentSkipNotify(Object content)     \r\n   at System.Xml.Linq.XContainer.AddContentSkipNotify(Object content)     \r\n   at OpenXmlPowerTools.HtmlToWml.HtmlToWmlConverterCore.UpdateMainDocumentPart(WordprocessingDocument wDoc, XElement html, HtmlToWmlConverterSettings settings)     \r\n   at OpenXmlPowerTools.HtmlToWml.HtmlToWmlConverterCore.ConvertHtmlToWml(String defaultCss, String authorCss, String userCss, XElement xhtml, HtmlToWmlConverterSettings settings, WmlDocument emptyDocument, String annotatedHtmlDumpFileName)     \r\n   at OpenXmlPowerTools.HtmlToWmlConverter.ConvertHtmlToWml(String defaultCss, String authorCss, String userCss, XElement xhtml, HtmlToWmlConverterSettings settings)     at WebOS.Engine.V100.WebOSIO.GenerateWordReport(List`1 Tables, Guid FileID, String FileName, ReportType FileType, Guid OwnerProgramID, RemoteLogin ID) \r\n\r\nI'm using nuget version 4.5.3.2\r\nCould you please help?\r\n\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2018-02-05T05:30:28.1447896Z","RunDurationInMilliseconds":1466}