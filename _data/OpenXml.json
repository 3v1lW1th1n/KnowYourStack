{"Data":{"Sdk":{"Events":[{"Id":"11103413741","Type":"PullRequestEvent","CreatedAt":"2019-12-17T03:45:26","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/650","RelatedDescription":"Opened pull request \"Publish symbol package\" (#650) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #639 "},{"Id":"11103388256","Type":"PullRequestEvent","CreatedAt":"2019-12-17T03:39:07","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/647","RelatedDescription":"Merged pull request \"Cache built constraints\" (#647) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11102431443","Type":"PullRequestEvent","CreatedAt":"2019-12-17T00:01:52","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/649","RelatedDescription":"Merged pull request \"Use in process benchmarks\" (#649) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11102430792","Type":"PullRequestEvent","CreatedAt":"2019-12-17T00:01:45","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/649","RelatedDescription":"Opened pull request \"Use in process benchmarks\" (#649) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11102303009","Type":"PullRequestEvent","CreatedAt":"2019-12-16T23:35:50","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/648","RelatedDescription":"Merged pull request \"Consolidate some SimpleTypes and update benchmark version\" (#648) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11102145202","Type":"PullRequestEvent","CreatedAt":"2019-12-16T23:05:51","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/648","RelatedDescription":"Opened pull request \"Consolidate some SimpleTypes and update benchmark version\" (#648) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11101047251","Type":"PullRequestEvent","CreatedAt":"2019-12-16T20:34:33","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/631","RelatedDescription":"Closed pull request \"Remove attributes for part constraints\" (#631) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11101042675","Type":"PullRequestEvent","CreatedAt":"2019-12-16T20:33:56","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/632","RelatedDescription":"Closed pull request \"Use in-params on large readonly structs\" (#632) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11101041437","Type":"PullRequestEvent","CreatedAt":"2019-12-16T20:33:46","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/647","RelatedDescription":"Opened pull request \"Cache built constraints\" (#647) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11101032458","Type":"PullRequestEvent","CreatedAt":"2019-12-16T20:32:36","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/646","RelatedDescription":"Merged pull request \"Use .NET Core 3.1 instead of .NET Core 3.0\" (#646) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11100298487","Type":"PullRequestEvent","CreatedAt":"2019-12-16T18:53:18","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/646","RelatedDescription":"Opened pull request \"Use list instead of dictionary when building validator collection\" (#646) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11087445026","Type":"IssuesEvent","CreatedAt":"2019-12-14T02:04:58","Actor":"paulresdat","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/645","RelatedDescription":"Opened issue \"Embedded documents with images breaks \"Save As\" on Word for Mac\" (#645) at OfficeDev/Open-XML-SDK","RelatedBody":"Is this a:\r\n- [x] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n**Description**\r\n\r\nUsing OpenXML, appending a word document with embedded images into another word document using `AddAlternativeFormatImportPart(AlternativeFormatImportPartType.WordprocessingML, altChunkId)` causes an issue where the user can not \"Save\" or \"Save As\" when altering the content in Word for Mac.\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Framework, .NET Core 3\r\n- DocumentFormat.OpenXml Version: 2.9.1\r\n\r\n**Repro**\r\n\r\n1. Create a new Console App in Visual Studio on Mac\r\n1. Add a folder to the top level called \"Docs\"\r\n1. Download the Nuget dependency DocumentFormat.OpenXml\r\n1. Create a new word doc named \"test-source.docx\"\r\n    1. Put some test text in there, doesn't matter what\r\n    1. Add the document to the solution in \"Docs\" folder\r\n    1. Change the property to \"Copy always\"\r\n1. Create a new word doc named \"test-append.docx\" (the embedded word doc)\r\n    1.  Put in some test text at the top\r\n    1. Copy over a jpg of your choice. The image type I used to reproduce is a jpg. I fetched mine from http://apod.nasa.gov/apod/ , one of their big pics should do it.\r\n    1. Add to the \"Docs\" folder in the solution\r\n    1. Change property of document to \"Copy always\"\r\n1. Copy paste the code below into your Program.cs file:\r\n\r\n```csharp\r\nusing System.IO;\r\nusing System.Linq;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Wordprocessing;\r\nusing Text = DocumentFormat.OpenXml.Wordprocessing.Text;\r\n\r\nnamespace TestWordAppend\r\n{\r\n    class Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            var destinationDoc = \"Docs/test-destination.docx\";\r\n            var sourceDoc = \"Docs/test-source.docx\";\r\n            var appendedDoc = \"Docs/test-append2.docx\";\r\n\r\n            File.Delete(destinationDoc);\r\n            File.Copy(sourceDoc, destinationDoc);\r\n\r\n            using (var doc = WordprocessingDocument.Open(destinationDoc, true))\r\n            {\r\n                var body = doc.MainDocumentPart.Document.Body;\r\n\r\n                var p2 = body.InsertAfter(\r\n                    new Paragraph(\r\n                        new ParagraphProperties(\r\n                            new PageBreakBefore()\r\n                    )),\r\n                    body.Elements<Paragraph>().Last()\r\n                );\r\n\r\n\r\n                var altChunkId = \"AltChunkId\";\r\n                var chunk = doc.MainDocumentPart.AddAlternativeFormatImportPart(\r\n                    AlternativeFormatImportPartType.WordprocessingML,\r\n                    altChunkId);\r\n\r\n                using (var fs = File.Open(appendedDoc, FileMode.Open))\r\n                    chunk.FeedData(fs);\r\n\r\n                var altChunk = new AltChunk { Id = altChunkId };\r\n                var run = new Run(new TabChar(), new Text(appendedDoc), new Break());\r\n                run.PrependChild(new RunProperties { RunStyle = new RunStyle { Val = \"Bold\" } });\r\n                var fileP = p2.InsertAfterSelf(new Paragraph());\r\n                fileP.Append(run);\r\n                run = new Run(new TabChar(), new Text(\"Uploaded by: \"), new TabChar(), new Text(\"Test User\"));\r\n                run.PrependChild(new RunProperties { RunStyle = new RunStyle { Val = \"Italic\" } });\r\n                fileP.Append(run);\r\n\r\n                body.Append(altChunk);\r\n                doc.MainDocumentPart.Document.Save();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n``` \r\n\r\n**Observed**\r\n\r\nWhen I open the destination document using Word on Mac, I will indeed see the document contents embedded in the destination document, however I can no longer utilize \"Save\" or \"Save As\".  Upon clicking \"save\" on a \"Save As\" when changing the name of the file, you will see the file name revert back to the original document name in the title and when you go to your \"Save As\" destination, you will not find a new document.  This problem does not exist in Word for Windows.\r\n\r\n**Expected**\r\n\r\nThe document should be able to be altered and saved within the MacOS Word application.\r\n"}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2019-12-17T05:30:50.3286047Z","RunDurationInMilliseconds":1050}