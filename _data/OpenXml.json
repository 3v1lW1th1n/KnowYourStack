{"Data":{"Sdk":{"Events":[{"Id":"11150244063","Type":"PullRequestEvent","CreatedAt":"2019-12-23T21:46:04","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/669","RelatedDescription":"Merged pull request \"Make fields readonly if possible\" (#669) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11150203151","Type":"IssuesEvent","CreatedAt":"2019-12-23T21:35:26","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/627","RelatedDescription":"Closed issue \"TableRowProperties does not expose child elements as properties\" (#627) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nThe `TableRowProperties` (`w:trPr`) class does not expose child elements such as `Deleted` (`w:del`) or `Inserted` (`w:ins`) as properties. This is in contrast to the `ParagraphMarkRunProperties` (`w:rPr`) class, for example, which exposes those child elements as properties.\r\n\r\nThis issue is related to #620, which also points out missing properties.\r\n\r\n**Information**\r\n\r\n- .NET Target: Any\r\n- DocumentFormat.OpenXml Version: 2.9.1\r\n\r\n**Repro**\r\n\r\nLook at source code.\r\n\r\n**Observed**\r\n\r\nInconsistency in API regarding which child elements it exposes.\r\n\r\n**Expected**\r\n\r\nAPI should consistently expose child elements."},{"Id":"11150162090","Type":"PullRequestEvent","CreatedAt":"2019-12-23T21:25:16","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/669","RelatedDescription":"Opened pull request \"Make fields readonly if possible\" (#669) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11150140941","Type":"PullRequestEvent","CreatedAt":"2019-12-23T21:20:04","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/668","RelatedDescription":"Merged pull request \"Lazily create XmlPath in ValidationErrorInfo\" (#668) at OfficeDev/Open-XML-SDK","RelatedBody":"If any errors are encountered, `ValidationErrorInfo` automatically creates an `Xmlpath` instance. However, this is somewhat expensive to create and may not be used. The validation perf test on master is this:\r\n\r\n| Method     | Mean     | Error   | StdDev  | Gen 0     | Allocated |\r\n| ---------- | -------- | ------- | ------- | --------- | --------- |\r\n| Before     | 141.8 ms | 2.75 ms | 2.70 ms | 5000.0000 | 23.72 MB  |\r\n| After      | 138.5 ms | 4.55 ms | 4.68 ms | 4000.0000 | 19.87 MB  |\r\n\r\nThere's a slight reduction in time, but a large reduction in Gen0 and overall allocations (~17%)"},{"Id":"11150006176","Type":"PullRequestEvent","CreatedAt":"2019-12-23T20:47:43","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/668","RelatedDescription":"Opened pull request \"Lazily create XmlPath in ValidationErrorInfo\" (#668) at OfficeDev/Open-XML-SDK","RelatedBody":"If any errors are encountered, `ValidationErrorInfo` automatically creates an `Xmlpath` instance. However, this is somewhat expensive to create and may not be used. The validation perf test on master is this:\r\n\r\n| Method     | Mean     | Error   | StdDev  | Gen 0     | Allocated |\r\n| ---------- | -------- | ------- | ------- | --------- | --------- |\r\n| Before     | 141.8 ms | 2.75 ms | 2.70 ms | 5000.0000 | 23.72 MB  |\r\n| After      | 138.5 ms | 4.55 ms | 4.68 ms | 4000.0000 | 19.87 MB  |\r\n\r\nThere's a slight reduction in time, but a large reduction in Gen0 and overall allocations (~17%)"},{"Id":"11141725847","Type":"PullRequestEvent","CreatedAt":"2019-12-22T02:03:08","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/667","RelatedDescription":"Merged pull request \"Use ValidationStack to track current element\" (#667) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11141590428","Type":"PullRequestEvent","CreatedAt":"2019-12-22T00:25:44","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/659","RelatedDescription":"Merged pull request \"Consider altChunk parts in Flat OPC transformation\" (#659) at OfficeDev/Open-XML-SDK","RelatedBody":"This commit enhances the\r\n\r\n  ```XDocument OpenXmlPackage.ToFlatOpcDocument(XProcessingInstruction)```\r\n\r\nmethod to consider \"altChunk parts\" (AlternativeFormatInputParts),\r\nwhich must have their content rendered in binary form even if it is XML\r\ncontent (e.g., XML, XHTML).\r\n\r\nFixes #525."},{"Id":"11141590422","Type":"IssuesEvent","CreatedAt":"2019-12-22T00:25:44","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/525","RelatedDescription":"Closed issue \"ToFlatOpcDocument and ToFlatOpcString deliver a document that is not useable in MS Word when there is an altChunk-Part\" (#525) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\nToFlatOpcDocument and ToFlatOpcString deliver a document that is not useable in MS Word when there is an altChunk-Part.\r\n\r\nWhen a document contains an altChunk-Part with content-Type \"application/xhtml+xm\" the conversion routine returns a part with a pkg:xmlData-Element.\r\nSuch documents cannot be processed in MS Word (tested in 2010 and 2016).\r\n\r\nMS Word expects altChunk-Parts always to be in a binary format in a Flat-OPC-document. Otherwise there is an error (Word says the document is corrupted and asks if it should repair the document).\r\nThe part information is lost when trying to repair the document in MS Word.\r\n\r\nThis is controlled in OpenXmlPackage.GetContentsAsXml by checking: part.ContentType.EndsWith(\"xml\")\r\nThe standard lists the following content-types for altChunk:\r\n- text/plain\r\n- text/html\r\n- application/vnd.openxmlformats-officedocument.wordprocessingml.document\r\n- application/xhtml+xml\r\n\r\nThe 3rd entry seems like an error because +xml is missing in the standard. I did not try altChunk with Word-Processing-ML but I suppose Word expects a binary part too.\r\nConsidering that, a check for ending of \"xml\" or \"+xml\" is not really feasible for the problem.\r\n\r\nTo be able to tell, if this is an altChunk-Part that should be binary (for MS Word) the Relationship-Type (\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk\" or the purl-Version \"http://purl.oclc.org/ooxml/officeDocument/relationships/aFChunk\") of the part should be checked and not the content-Type of the part.\r\nThe check for \"xml\" could be done after this check for altChunk but should anyway rather be for \"+xml\" instead.\r\n\r\n**Information**\r\n\r\n- .NET Target: 4.6.1\r\n- DocumentFormat.OpenXml Version: 2.7.2 but code in 2.9 seams to have the same issue.\r\n\r\n**Repro**\r\nSee Unit-Test at:\r\nhttps://gist.github.com/rominator1983/248dcd826802eeb0a768f18fe709f2b1\r\n\r\nAn additional file (docx with altchunk) is needed:\r\nhttps://amforst.ddns.net/s/qd5RELXM6TeMX8t\r\n\r\n**Observed**\r\naltChunk-Part is returned as XML-Part instead of binary.\r\n\r\n**Expected**\r\naltChunk-Part is returned as binary-Part instead of XML-Part.\r\n\r\n---\r\nCopied from https://gist.github.com/rominator1983/248dcd826802eeb0a768f18fe709f2b1 for easier discoverability:\r\n\r\n```csharp\r\nusing System.IO;\r\nusing System.IO.Packaging;\r\nusing DocumentFormat.OpenXml;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing NUnit.Framework;\r\n\r\nnamespace ConversionTestNamespace\r\n{\r\n  [TestFixture]\r\n  public class ConvertTest\r\n  {\r\n    [Test]\r\n    public void Convert ()\r\n    {\r\n      // download file from: https://amforst.ddns.net/s/qd5RELXM6TeMX8t\r\n      using (var package = Package.Open (@\"c:\\\\temp\\\\Doc with altChunk.docx\", FileMode.Open))\r\n      {\r\n        using (var wordprocessingDocument = WordprocessingDocument.Create (package, WordprocessingDocumentType.Document))\r\n        {\r\n          var flatOpcDocumentString = wordprocessingDocument.ToFlatOpcString ();\r\n\r\n          Assert.That (flatOpcDocumentString, Does.Contain(\"pkg:binaryData\"));\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```"},{"Id":"11137980203","Type":"PullRequestEvent","CreatedAt":"2019-12-20T20:57:13","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/667","RelatedDescription":"Opened pull request \"Use ValidationStack to track current element\" (#667) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11137937575","Type":"PullRequestEvent","CreatedAt":"2019-12-20T20:49:19","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/664","RelatedDescription":"Merged pull request \"Refactor ValidationStack and use for Part and Package\" (#664) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"11137933335","Type":"PullRequestEvent","CreatedAt":"2019-12-20T20:48:34","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/665","RelatedDescription":"Closed pull request \"[WIP] Add validation stack as separate class\" (#665) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2019-12-24T05:30:50.9181523Z","RunDurationInMilliseconds":1775}