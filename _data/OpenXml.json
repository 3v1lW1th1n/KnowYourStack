{"Data":{"Sdk":{"Events":[{"Id":"9211808999","Type":"IssuesEvent","CreatedAt":"2019-03-09T18:28:36","Actor":"PJBowron","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/567","RelatedDescription":"Opened issue \"Unable to build release with .Net native toolchain\" (#567) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nA project incorporating the OpenXML package will fail to build in Release config if the build is set to use the .Net native toolchain (required for Store submision).\r\n\r\n**Information**\r\n\r\n- Target: UWP\r\n- DocumentFormat.OpenXml Version: 2.9.0\r\n\r\n**Repro**\r\n\r\n- Create/Open a solution & project and add the OpenXML package\r\n- Right-click on project in Solution Explorer and select \"Properties\"\r\n- With Build selected, choose \"Release\" for Configuration and \"All Platforms\" for Platform\r\n- Ensure \"Compile with .Net Native tool chain\" is ticked\r\n- Build the solution for Release/x86\r\n\r\n**Observed**\r\n\r\nBuild failure:\r\n`Error\t\tMCG0037: MCG0037:InvalidCSharpIdentifierName Struct 'DocumentFormat.OpenXml.Validation.Schema.SdbAttributeConstraint' in assembly 'Assembly(Name=DocumentFormat.OpenXml, Version=2.9.0.0, Culture=neutral, PublicKeyToken=8fb06cb64d019a17)' has a field with name '<AttributeUse>k__BackingField' that is invalid. This could be because the name is obfuscated or the field is auto-implemented by the compiler. Please make sure the field name follows C# identifier conventions.\r\n`\r\n\r\n**Expected**\r\n\r\nSuccessful build.\r\n"},{"Id":"9190128952","Type":"IssuesEvent","CreatedAt":"2019-03-06T11:59:25","Actor":"AlexHedley","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/566","RelatedDescription":"Opened issue \"SAX Approach Replace Example\" (#566) at OfficeDev/Open-XML-SDK","RelatedBody":"I'm looking for an example of using the SAX approach (instead of DOM) to open a large file and perform a replace on a given value, then save the file.\r\n\r\nI think this would be a useful addition to the [Documentation](https://docs.microsoft.com/en-gb/office/open-xml/open-xml-sdk).\r\n\r\nHow to: Search and replace text in a document part (Open XML SDK)\r\nhttps://docs.microsoft.com/en-us/office/open-xml/how-to-search-and-replace-text-in-a-document-part\r\n\r\nThis uses a `Stream`.\r\n\r\nHow to: Parse and read a large spreadsheet document (Open XML SDK)\r\nhttps://docs.microsoft.com/en-us/office/open-xml/how-to-parse-and-read-a-large-spreadsheet\r\n\r\n```csharp\r\n// The SAX approach.\r\nstatic void ReadExcelFileSAX(string fileName)\r\n{\r\n    using (SpreadsheetDocument spreadsheetDocument = SpreadsheetDocument.Open(fileName, false))\r\n    {\r\n        WorkbookPart workbookPart = spreadsheetDocument.WorkbookPart;\r\n        WorksheetPart worksheetPart = workbookPart.WorksheetParts.First();\r\n\r\n        OpenXmlReader reader = OpenXmlReader.Create(worksheetPart);\r\n        string text;\r\n        while (reader.Read())\r\n        {\r\n            if (reader.ElementType == typeof(CellValue))\r\n            {\r\n                text = reader.GetText();\r\n                Console.Write(text + \" \");\r\n            }\r\n        }\r\n        Console.WriteLine();\r\n        Console.ReadKey();\r\n    }\r\n}\r\n```\r\n\r\n---\r\n\r\nIf I read in the \"text\" and wish to replace this:\r\n\r\n```csharp\r\nusing (WordprocessingDocument wordDoc = WordprocessingDocument.Open(filePath, true))\r\n{\r\n    Document document = wordDoc.MainDocumentPart.Document;\r\n    OpenXmlReader reader = OpenXmlReader.Create(document);\r\n    while (reader.Read())\r\n    {\r\n        //OpenXmlElement element = reader.LoadCurrentElement();\r\n        //text = element.InnerText;\r\n        text = reader.GetText();\r\n    }\r\n}\r\n```\r\n\r\n`OpenXmlWriter` expects an `OpenXmlPart` or `Stream` when you create it.\r\n\r\n```csharp\r\nOpenXmlWriter writer = OpenXmlWriter.Create(#);\r\nwriter.WriteStartElement(reader);\r\nwriter.WriteElement(#);\r\nwriter.WriteEndElement();\r\nwriter.Close();\r\n```\r\n\r\nWhat is the supported approach/method for this?\r\n\r\nUsing the DOM approach on large files can cause memory exceptions.\r\n\r\n---\r\n\r\nThere are a number of blog posts documenting how to use the `OpenXmlWriter` but this is for creating new files or adding new elements to an existing file, not updating existing data.\r\n\r\n**Parsing and Reading Large Excel Files with the Open XML SDK**\r\nhttp://blogs.msdn.com/b/brian_jones/archive/2010/05/27/parsing-and-reading-large-excel-files-with-the-open-xml-sdk.aspx [Dead Link]\r\nhttps://web.archive.org/web/20151205145806/http://blogs.msdn.com/b/brian_jones/archive/2010/05/27/parsing-and-reading-large-excel-files-with-the-open-xml-sdk.aspx\r\n\r\n**Writing Large Excel Files with the Open XML SDK**\r\nhttp://blogs.msdn.com/b/brian_jones/archive/2010/06/22/writing-large-excel-files-with-the-open-xml-sdk.aspx [Dead Link]\r\nhttps://web.archive.org/web/20160216062257/http://blogs.msdn.com/b/brian_jones/archive/2010/06/22/writing-large-excel-files-with-the-open-xml-sdk.aspx\r\n\r\n**Performance issue while reading/writing large excel files using OpenXML SDK**\r\nhttp://tech-turf.blogspot.com/2015/10/performance-issue-while-readingwriting.html\r\n\r\n**How to read and write Excel cells with OpenXML and C#**\r\nhttp://fczaja.blogspot.com/2013/05/how-to-read-and-write-excel-cells-with.html\r\n\r\n**How to properly use OpenXmlWriter to write large Excel files**\r\nhttp://polymathprogrammer.com/2012/08/06/how-to-properly-use-openxmlwriter-to-write-large-excel-files/"},{"Id":"9187673486","Type":"PullRequestEvent","CreatedAt":"2019-03-06T03:59:24","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/565","RelatedDescription":"Merged pull request \"Clean up namespace to id mapper\" (#565) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"9187493240","Type":"PullRequestEvent","CreatedAt":"2019-03-06T03:07:53","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/565","RelatedDescription":"Opened pull request \"Clean up namespace to id mapper\" (#565) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"9149388669","Type":"IssuesEvent","CreatedAt":"2019-02-27T19:40:15","Actor":"jchoinski","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/564","RelatedDescription":"Opened issue \"Office Online created document fails OpenXmlValidator validation\" (#564) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nAny document created in Office Online, including blank ones fail OpenXmlValidator validation. \r\n\r\n                var v = new OpenXmlValidator(FileFormatVersions.Office2016);\r\n                var errors = v.Validate(wDoc);\r\n\r\nProduces the following 2 errors :\r\n\r\n1. \r\nAttributeQualifiedName: null\r\nDescription: The element has unexpected child element 'http://schemas.microsoft.com/office/word/2010/wordml:docId'.\r\nErrorType: Schema\r\nId: Sch_UnexpectedElementContentExpectingComplex\r\nNode: {DocumentFormat.OpenXml.Wordprocessing.Settings}\r\nPart: {DocumentFormat.OpenXml.Packaging.DocumentSettingsPart}\r\nPath: XPath=\"/w:settings[1]\"\r\nRelatedNode: {DocumentFormat.OpenXml.Office2010.Word.DocumentId}\r\n\r\n2.\r\nAttributeQualifiedName: http://schemas.microsoft.com/office/word/2012/wordml:val\r\nDescription: \"The attribute 'http://schemas.microsoft.com/office/word/2012/wordml:val' has invalid value '{7297be79-5e23-470a-9fe2-a7ede5c0760f}'. The Pattern constraint failed. The expected pattern is \\\\{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}\\\\}.\"\r\nErrorType: Schema\r\nId: Sch_AttributeValueDataTypeDetailed\r\nNode: {DocumentFormat.OpenXml.Office2013.Word.PersistentDocumentId}\r\nPart: {DocumentFormat.OpenXml.Packaging.DocumentSettingsPart}\r\nPath: XPath=\"/w:settings[1]/w15:docId[1]\"\r\nRelatedNode: null\r\nValidationErrorCategory: Sch_PatternConstraintFailed\r\n**Information**\r\n\r\n- .NET Target: .NET Framework,\r\n- DocumentFormat.OpenXml Version:  feature/office2016\r\n\r\n**Repro**\r\n#\r\n        [Theory]\r\n        [InlineData(TestFiles.O365BlankDocument)]\r\n        public void OF16_001_ValidateDocx_2016(string name)\r\n        {\r\n            using (var stream = GetStream(name))\r\n            using (var wDoc = WordprocessingDocument.Open(stream, false))\r\n            {\r\n                var v = new OpenXmlValidator(FileFormatVersions.Office2016);\r\n                var errors = v.Validate(wDoc);\r\n\r\n                Assert.Empty(errors);\r\n            }\r\n        }\r\n\r\n**Observed**\r\n\r\nValidation produces 2 errors\r\n\r\n**Expected**\r\n\r\nValidation produces 0 errors\r\n"}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[{"Id":"8996877097","Type":"PullRequestEvent","CreatedAt":"2019-02-02T05:48:33","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/271","RelatedDescription":"Merged pull request \"Replace file headers with MIT license\" (#271) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""},{"Id":"8996442444","Type":"PullRequestEvent","CreatedAt":"2019-02-02T01:27:29","Actor":"twsouthwick","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/271","RelatedDescription":"Opened pull request \"Replace file headers with MIT license\" (#271) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""},{"Id":"8996441806","Type":"PullRequestEvent","CreatedAt":"2019-02-02T01:27:15","Actor":"tomjebo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/270","RelatedDescription":"Closed pull request \"update DocumentFormat.OpenXml to 2.9.0\" (#270) at OfficeDev/Open-Xml-PowerTools","RelatedBody":""},{"Id":"8996440977","Type":"PullRequestEvent","CreatedAt":"2019-02-02T01:26:52","Actor":"tomjebo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/256","RelatedDescription":"Closed pull request \"Fix issue related to text-align with rtl direction\" (#256) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"When adding style=\"direction:rtl; text-align:left\" it doesn't apply text-align property."},{"Id":"8996440049","Type":"PullRequestEvent","CreatedAt":"2019-02-02T01:26:27","Actor":"tomjebo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/247","RelatedDescription":"Closed pull request \"Update ChartUpdater.cs\" (#247) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"UpdateChart.UpdateChart.UpdateSeries does not work on Radar chart types, it is a simple one line fix that I have used for a few years now.\r\nCloses OfficeDev/Open-Xml-PowerTools#245"},{"Id":"8996439414","Type":"PullRequestEvent","CreatedAt":"2019-02-02T01:26:11","Actor":"tomjebo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/246","RelatedDescription":"Closed pull request \"Process page breaks\" (#246) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Page breaks are shown like \r\n\r\n    <p:r><docx properties like font, .../><w:br type=\"page\"/></p:r>\r\n\r\nWhen converting this to HTML, this is replaced by <span></span> in the function:\r\n\r\n     // Transform w:br to h:br.\r\n     if (element.Name == W.br || element.Name == W.cr)\r\n      {\r\n           return ProcessBreak(element);\r\n      }\r\n\r\nWhich causes the page break to not appear.\r\n\r\nI have changed this so it returns a div style=\"page-break-before:always;\"  in the following function.\r\n\r\n    private static object ProcessPageBreak(XElement element)\r\n        {\r\n            XElement div = new XElement(Xhtml.div);\r\n            div.SetAttributeValue(NoNamespace.style, \"page-break-before:always;\");\r\n            XElement span = null;\r\n\r\n            return new object[]\r\n            {\r\n                div,\r\n                new XEntity(\"#x200e\"),\r\n                span\r\n         };\r\n        }\r\n\r\nWhich causes a correct page break.\r\n\r\nPS. The page break (docx) is detected in a child element. So i have to set the page break ( html) in it's parent. I detect it with the following function:\r\n\r\n     private static bool HasAPageBreak(XElement element)\r\n        {\r\n            return element.Descendants().Any(dl => dl.Name == W.br && dl.Attribute(W.type).Value == \"page\");\r\n        }\r\n"},{"Id":"8996438798","Type":"PullRequestEvent","CreatedAt":"2019-02-02T01:25:55","Actor":"tomjebo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/241","RelatedDescription":"Closed pull request \"Document Assembler: Ability to merge in whole documents or sub-templates\" (#241) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"As some interest was shown in this feature here is the pull request.\r\n\r\nFrom issue 191;\r\n\r\nImplementation is as follows;\r\n\r\n- Added two new elements; Document and DocumentTemplate\r\n- These two elements share common attributes Path and Data\r\n- The Path attribute can be either a file path or XPath that retrieves a file path from the input XML\r\n- The Data attribute is intended to hold a base64 encoded string containing the Word document contents\r\n- The DocumentTemplate element also has a Select attribute so that XML data can be passed to the template\r\n\r\ne.g.\r\n\r\n```\r\n<Repeat Select=\"//Invoice\" />\r\n<DocumentTemplate Path=\"SubTemplate.docx\" Select=\".\" />\r\n<Document Path=\"Terms.docx\" />\r\n<EndRepeat />\r\n\r\n```\r\nWith the above in place what I do is take a two pass approach.\r\n\r\nFirstly I process the Document and DocumentTemplate elements converting all to a Document element which contains a Data attribute with the base64 encoded content of the Document or assembled DocumentTemplate.\r\n\r\nThen I have introduced a second step and as such a dependency on DocumentBuilder in DocumentAssembler. I am not sure if this will be frowned upon or not :)\r\n\r\nThis second step is largely based on this post from Eric White;\r\n\r\nhttps://blogs.msdn.microsoft.com/ericwhite/2009/04/21/using-documentbuilder-with-content-controls-for-document-assembly/\r\n\r\n\r\nAlthough in my practical experience (been using this code in production for months) the Word documents generated are valid I had issues with the Unit Tests.  I think this is because we are using Office 365 and it looks like the validator only supports up-to 2013 at the minute?  I could re-author my test files in 2013 but don't have access to a copy.\r\n\r\nAny comments and feedback appreciated, this is my first pull request on an open-source project so be gentle :)"},{"Id":"8996438011","Type":"PullRequestEvent","CreatedAt":"2019-02-02T01:25:37","Actor":"tomjebo","Repository":"OfficeDev/Open-Xml-PowerTools","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-Xml-PowerTools/pull/237","RelatedDescription":"Closed pull request \"Added missing image/bmp type to ImageContentTypes\" (#237) at OfficeDev/Open-Xml-PowerTools","RelatedBody":"Added \"bmp\" format into content types to fix missing images issue after conversion to html."}],"ResultType":"GitHubEvent"}},"RunOn":"2019-03-11T05:30:39.6546312Z","RunDurationInMilliseconds":1067}